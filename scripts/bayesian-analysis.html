<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pawel Wiczling">
<meta name="author" content="Paulina Okuńska">
<meta name="dcterms.date" content="2025-03-28">

<title>Pharmacokinetics of sufentanil after epidural administration</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="bayesian-analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="bayesian-analysis_files/libs/quarto-html/quarto.js"></script>
<script src="bayesian-analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="bayesian-analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="bayesian-analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="bayesian-analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="bayesian-analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="bayesian-analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="bayesian-analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="bayesian-analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#settings" id="toc-settings" class="nav-link" data-scroll-target="#settings">Settings</a></li>
  <li><a href="#plotting-functions" id="toc-plotting-functions" class="nav-link" data-scroll-target="#plotting-functions">Plotting functions</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">EDA</a>
  <ul class="collapse">
  <li><a href="#plot-raw-data" id="toc-plot-raw-data" class="nav-link" data-scroll-target="#plot-raw-data">Plot raw data</a></li>
  <li><a href="#patients-demographics" id="toc-patients-demographics" class="nav-link" data-scroll-target="#patients-demographics">Patients demographics</a></li>
  </ul></li>
  <li><a href="#stan" id="toc-stan" class="nav-link" data-scroll-target="#stan">Stan</a></li>
  <li><a href="#m1-2cmp-disposition-model-1-comp-abs" id="toc-m1-2cmp-disposition-model-1-comp-abs" class="nav-link" data-scroll-target="#m1-2cmp-disposition-model-1-comp-abs">M1: 2cmp disposition model + 1 comp abs</a>
  <ul class="collapse">
  <li><a href="#run-stan" id="toc-run-stan" class="nav-link" data-scroll-target="#run-stan">Run stan</a></li>
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">Parameters</a></li>
  <li><a href="#trace-plots" id="toc-trace-plots" class="nav-link" data-scroll-target="#trace-plots">Trace plots</a></li>
  <li><a href="#individual-and-population-predictions" id="toc-individual-and-population-predictions" class="nav-link" data-scroll-target="#individual-and-population-predictions">Individual and population predictions</a></li>
  <li><a href="#vpc" id="toc-vpc" class="nav-link" data-scroll-target="#vpc">VPC</a></li>
  <li><a href="#gof" id="toc-gof" class="nav-link" data-scroll-target="#gof">GOF</a></li>
  <li><a href="#individual-parameters-vs.-covariates" id="toc-individual-parameters-vs.-covariates" class="nav-link" data-scroll-target="#individual-parameters-vs.-covariates">Individual parameters vs.&nbsp;covariates</a></li>
  </ul></li>
  <li><a href="#m3-2cmp-model-2cmp-absorption" id="toc-m3-2cmp-model-2cmp-absorption" class="nav-link" data-scroll-target="#m3-2cmp-model-2cmp-absorption">M3: 2cmp model + 2cmp absorption</a>
  <ul class="collapse">
  <li><a href="#run-stan-1" id="toc-run-stan-1" class="nav-link" data-scroll-target="#run-stan-1">Run stan</a></li>
  <li><a href="#parameters-1" id="toc-parameters-1" class="nav-link" data-scroll-target="#parameters-1">Parameters</a>
  <ul class="collapse">
  <li><a href="#half-lifes" id="toc-half-lifes" class="nav-link" data-scroll-target="#half-lifes">Half-lifes</a></li>
  </ul></li>
  <li><a href="#trace-plots-1" id="toc-trace-plots-1" class="nav-link" data-scroll-target="#trace-plots-1">Trace plots</a></li>
  <li><a href="#individual-and-population-predictions-1" id="toc-individual-and-population-predictions-1" class="nav-link" data-scroll-target="#individual-and-population-predictions-1">Individual and population predictions</a></li>
  <li><a href="#vpc-1" id="toc-vpc-1" class="nav-link" data-scroll-target="#vpc-1">VPC</a></li>
  <li><a href="#gof-1" id="toc-gof-1" class="nav-link" data-scroll-target="#gof-1">GOF</a></li>
  <li><a href="#individual-parameters-vs.-covariates-1" id="toc-individual-parameters-vs.-covariates-1" class="nav-link" data-scroll-target="#individual-parameters-vs.-covariates-1">Individual parameters vs.&nbsp;covariates</a></li>
  <li><a href="#shrinkage" id="toc-shrinkage" class="nav-link" data-scroll-target="#shrinkage">Shrinkage</a></li>
  </ul></li>
  <li><a href="#m3p-prior-predicitve-check.-2cmp-model-2cmp-absorption" id="toc-m3p-prior-predicitve-check.-2cmp-model-2cmp-absorption" class="nav-link" data-scroll-target="#m3p-prior-predicitve-check.-2cmp-model-2cmp-absorption">M3p: Prior predicitve check. 2cmp model + 2cmp absorption</a>
  <ul class="collapse">
  <li><a href="#run-stan-2" id="toc-run-stan-2" class="nav-link" data-scroll-target="#run-stan-2">Run stan</a></li>
  <li><a href="#parameters-2" id="toc-parameters-2" class="nav-link" data-scroll-target="#parameters-2">Parameters</a></li>
  <li><a href="#parameters-figure" id="toc-parameters-figure" class="nav-link" data-scroll-target="#parameters-figure">Parameters (figure)</a></li>
  <li><a href="#trace-plots-2" id="toc-trace-plots-2" class="nav-link" data-scroll-target="#trace-plots-2">Trace plots</a></li>
  <li><a href="#individual-and-population-predictions-prior-predictive-check" id="toc-individual-and-population-predictions-prior-predictive-check" class="nav-link" data-scroll-target="#individual-and-population-predictions-prior-predictive-check">Individual and population predictions (Prior predictive check)</a></li>
  <li><a href="#vpc-prior-predictive-check" id="toc-vpc-prior-predictive-check" class="nav-link" data-scroll-target="#vpc-prior-predictive-check">VPC (Prior predictive check)</a></li>
  <li><a href="#compare-m3b" id="toc-compare-m3b" class="nav-link" data-scroll-target="#compare-m3b">Compare M3b</a>
  <ul class="collapse">
  <li><a href="#parameters-figure-1" id="toc-parameters-figure-1" class="nav-link" data-scroll-target="#parameters-figure-1">Parameters (figure)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#compare-models" id="toc-compare-models" class="nav-link" data-scroll-target="#compare-models">Compare models</a></li>
  <li><a href="#manuscript-figures" id="toc-manuscript-figures" class="nav-link" data-scroll-target="#manuscript-figures">Manuscript figures</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#licenses" id="toc-licenses" class="nav-link" data-scroll-target="#licenses">Licenses</a></li>
  <li><a href="#original-computing-environment" id="toc-original-computing-environment" class="nav-link" data-scroll-target="#original-computing-environment">Original Computing Environment</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Pharmacokinetics of sufentanil after epidural administration</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Pawel Wiczling </p>
             <p>Paulina Okuńska </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 28, 2025</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Pharmacokinetics of sufentanil after epidural administration.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bbr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bbr.bayes)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mrgsolve)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vpc)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pmplots)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(whisker)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pmplots)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pmtables)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nmrec)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggh4x)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(loo)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">set_cmdstan_path</span>(<span class="st">"C:/Users/GUMed/Documents/.cmdstan/Torsten-0.91.0/cmdstan"</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">#' helper functions</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>,<span class="st">"functions"</span>,<span class="st">"functions-tables.R"</span>))</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># table summary </span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>sigfun <span class="ot">=</span> <span class="cf">function</span>(.x){<span class="fu">sig</span>(.x,<span class="at">digits=</span><span class="dv">3</span>)}</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">#for the future:</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("metrumresearchgroup/nmrec")</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("metrumresearchgroup/bbr", ref = "main")</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/metrumresearchgroup/NMBayesTutorial/tree/main</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>thisScript <span class="ot">&lt;-</span> <span class="st">"bayesian-analysis.qmd"</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co"># cmdstanr::check_cmdstan_toolchain()</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># rebuild_cmdstan(</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   dir = cmdstan_path(),</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   cores = getOption("mc.cores", 16),</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   quiet = FALSE,</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   timeout = 600)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="settings" class="level1">
<h1>Settings</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"derived"</span>) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>model_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model"</span>,<span class="st">"torsten"</span>)  </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>figures_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"deliv"</span>,<span class="st">"figures"</span>, <span class="st">"torsten"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>tables_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"deliv"</span>,<span class="st">"tables"</span>, <span class="st">"torsten"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plotting-functions" class="level1">
<h1>Plotting functions</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>plot_param_tables <span class="ot">&lt;-</span><span class="cf">function</span>(mod_to_plot, pars){ </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  mod_to_plot<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(pars)) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">formatC</span>(., <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">parameter =</span> variable) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"90% CI"</span> <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">"("</span>, q5, <span class="st">", "</span>, q95, <span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(parameter, mean, median, sd, mad, <span class="st">"90% CI"</span>, ess_bulk, ess_tail, rhat)<span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(parameter, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"</span><span class="sc">\\</span><span class="st">[1,1</span><span class="sc">\\</span><span class="st">]|</span><span class="sc">\\</span><span class="st">[2,2</span><span class="sc">\\</span><span class="st">]|</span><span class="sc">\\</span><span class="st">[3,3</span><span class="sc">\\</span><span class="st">]|</span><span class="sc">\\</span><span class="st">[4,4</span><span class="sc">\\</span><span class="st">]|</span><span class="sc">\\</span><span class="st">[5,5</span><span class="sc">\\</span><span class="st">]|</span><span class="sc">\\</span><span class="st">[6,6</span><span class="sc">\\</span><span class="st">]|</span><span class="sc">\\</span><span class="st">[7,7</span><span class="sc">\\</span><span class="st">]"</span>, <span class="at">negate =</span> T))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>pred_by_id_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mod_to_plot, xdata){</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  predInd <span class="ot">&lt;-</span>  posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"cCond"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"cCond"</span>),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">name =</span> forcats<span class="sc">::</span>fct_inorder)) <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">lbInd =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianInd =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">ubInd =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.95</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>predPop <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"cPred"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"cPred"</span>),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">name =</span> forcats<span class="sc">::</span>fct_inorder)) <span class="sc">%&gt;%</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">lbPop =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianPop =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">ubPop =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.95</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>predAll <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(xdata, predInd, predPop) <span class="sc">%&gt;%</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DV =</span> <span class="fu">if_else</span>(EVID<span class="sc">==</span><span class="dv">0</span>,DV, <span class="cn">NA</span>))</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(predAll, <span class="fu">aes</span>(<span class="at">x =</span> TIMEh, <span class="at">y =</span> DV)) <span class="sc">+</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIMEh, <span class="at">y =</span> medianPop, <span class="at">color =</span> <span class="st">"population"</span>)) <span class="sc">+</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lbPop, <span class="at">ymax =</span> ubPop, <span class="at">fill =</span> <span class="st">"population"</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIMEh, <span class="at">y =</span> medianInd, <span class="at">color =</span> <span class="st">"individual"</span>)) <span class="sc">+</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lbInd, <span class="at">ymax =</span> ubInd, <span class="at">fill =</span> <span class="st">"individual"</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">name  =</span><span class="st">"prediction"</span>,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"individual"</span>, <span class="st">"population"</span>),</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">name  =</span><span class="st">"prediction"</span>,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"individual"</span>, <span class="st">"population"</span>),</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>                    <span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time (h)"</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sufentanil concentrations, pg/ml"</span>) <span class="sc">+</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">200</span>))<span class="sc">+</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>vpc_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mod_to_plot, xdata){</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>nPost <span class="ot">&lt;-</span> mod_to_plot<span class="sc">$</span><span class="fu">metadata</span>()<span class="sc">$</span>iter_sampling <span class="sc">/</span> mod_to_plot<span class="sc">$</span><span class="fu">metadata</span>()<span class="sc">$</span>thin</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>n_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>inf_labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"During infusion"</span>,</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"Post infusion"</span>)</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>predPop <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"cPred"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"cPred"</span>),</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">name =</span> forcats<span class="sc">::</span>fct_inorder)) <span class="sc">%&gt;%</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>ID, n_chains <span class="sc">*</span> nPost),</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>         <span class="at">TIME =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>TIME, n_chains <span class="sc">*</span> nPost),</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>         <span class="at">CMT =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>CMT, n_chains <span class="sc">*</span> nPost),</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>         <span class="at">EVID =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>EVID, n_chains <span class="sc">*</span> nPost),</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">infusion =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>infusion, n_chains <span class="sc">*</span> nPost),</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>         <span class="at">DV =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>DV, n_chains <span class="sc">*</span> nPost)) <span class="sc">%&gt;%</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.iteration<span class="sc">&lt;=</span><span class="dv">250</span>)</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span>predPop <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(DV)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EVID<span class="sc">==</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">infusion =</span> <span class="fu">as.factor</span>(infusion))</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>obs <span class="ot">&lt;-</span> xdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(DV)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EVID<span class="sc">==</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">infusion =</span> <span class="fu">as.factor</span>(infusion))</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>vpc_plot <span class="ot">&lt;-</span> <span class="fu">vpc</span>(<span class="at">sim =</span> sim,</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>               <span class="at">obs =</span> obs,</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>               <span class="at">obs_cols =</span> <span class="fu">list</span>(<span class="at">id =</span> <span class="st">"ID"</span>, <span class="at">dv =</span> <span class="st">"DV"</span>, <span class="at">idv =</span> <span class="st">"TIME"</span>),</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>               <span class="at">sim_cols =</span> <span class="fu">list</span>(<span class="at">is =</span> <span class="st">"ID"</span>, <span class="at">dv =</span> <span class="st">"value"</span>, <span class="at">idv =</span> <span class="st">"TIME"</span>),</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>               <span class="at">ci =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>), <span class="at">pi =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>),</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>               <span class="at">stratify =</span> <span class="st">"infusion"</span>,</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>               <span class="at">bins =</span> <span class="st">"jenks"</span>,</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>               <span class="at">log_y =</span> T,</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>               <span class="at">log_y_min =</span> <span class="fl">0.04</span>,</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free_x"</span>,</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">infusion =</span> inf_labs),</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>               <span class="at">show =</span> <span class="fu">list</span>(<span class="at">obs_dv =</span> <span class="cn">TRUE</span>, <span class="at">obs_ci =</span> <span class="cn">TRUE</span>, </span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pi =</span> <span class="cn">FALSE</span>, <span class="at">pi_as_area =</span> <span class="cn">FALSE</span>, <span class="at">pi_ci =</span> <span class="cn">TRUE</span>, </span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>                           <span class="at">obs_median =</span> <span class="cn">TRUE</span>, <span class="at">sim_median =</span> <span class="cn">FALSE</span>, <span class="at">sim_median_ci =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>               <span class="at">vpc_theme =</span> <span class="fu">new_vpc_theme</span>(<span class="at">update =</span> <span class="fu">list</span>(</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sim_pi_fill =</span> <span class="st">"snow4"</span>,</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sim_pi_alpha =</span> <span class="fl">0.25</span>,</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>                 <span class="at">obs_ci_size =</span> <span class="dv">1</span>,</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>                 <span class="at">obs_ci_color =</span> <span class="st">"snow4"</span>,</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>                 <span class="at">obs_median_color =</span> <span class="st">"royalblue"</span>,</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>                 <span class="at">obs_ci_linetype =</span> <span class="dv">1</span>,</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sim_median_fill =</span> <span class="st">"royalblue"</span>,</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sim_median_alpha =</span> <span class="fl">0.25</span>)))<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>vpc_plot <span class="ot">&lt;-</span> vpc_plot <span class="sc">+</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time (h)"</span>,</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sufentanil concentrations, pg/ml"</span>) </span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>vpc_plot</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>gof_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mod_to_plot, xdata){</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>yrepCond <span class="ot">&lt;-</span> <span class="fu">as_draws_matrix</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"cCond"</span>)))</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>yrepPred <span class="ot">&lt;-</span> <span class="fu">as_draws_matrix</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"cPred"</span>)))</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a> yobs <span class="ot">&lt;-</span> xdata<span class="sc">$</span>DV</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a> ktore <span class="ot">&lt;-</span> xdata<span class="sc">$</span>CMT<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;</span> xdata<span class="sc">$</span>EVID<span class="sc">==</span><span class="dv">0</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a> p1 <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_intervals</span>(<span class="at">y =</span> <span class="dv">1000</span><span class="sc">+</span>yobs[ktore], <span class="at">yrep =</span> yrepCond[,ktore], <span class="at">x =</span> yobs[ktore]) <span class="sc">+</span> </span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">"Observed (ng/ml)"</span>) <span class="sc">+</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">"Individual predictions (ng/ml)"</span>) <span class="sc">+</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span> </span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">"grey"</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a> p2 <span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">ppc_intervals</span>(<span class="at">y =</span> <span class="dv">1000</span><span class="sc">+</span>yobs[ktore], <span class="at">yrep =</span> yrepPred[,ktore], <span class="at">x =</span> yobs[ktore]) <span class="sc">+</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Observed (ng/ml)"</span>) <span class="sc">+</span> </span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">"Population predictions (ng/ml)"</span>) <span class="sc">+</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">"grey"</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>plot_all <span class="ot">&lt;-</span> (p1<span class="sc">+</span>p2)</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>plot_all</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>fun_cont_cov<span class="ot">&lt;-</span><span class="cf">function</span>(cov,etaM){</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(etaM, <span class="fu">aes_string</span>(<span class="at">x=</span><span class="fu">gsub</span>(<span class="st">"//.*"</span>,<span class="st">""</span>,cov), <span class="at">y=</span><span class="st">"medianInd"</span>)) <span class="sc">+</span> </span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lbInd, <span class="at">ymax=</span>ubInd), <span class="at">width=</span>.<span class="dv">2</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.05</span>))<span class="sc">+</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"gray"</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Etas"</span>,<span class="at">x=</span><span class="fu">gsub</span>(<span class="st">".*//"</span>,<span class="st">""</span>,cov))<span class="sc">+</span></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(p1)</span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>fun_cat_cov<span class="ot">&lt;-</span><span class="cf">function</span>(cov,etaM){</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(etaM, <span class="fu">aes_string</span>(<span class="at">x=</span><span class="fu">gsub</span>(<span class="st">"//.*"</span>,<span class="st">""</span>,cov), <span class="at">y=</span><span class="st">"medianInd"</span>)) <span class="sc">+</span> </span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()<span class="sc">+</span></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"gray"</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Etas"</span>,<span class="at">x=</span><span class="fu">gsub</span>(<span class="st">".*//"</span>,<span class="st">""</span>,cov))<span class="sc">+</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(p1)</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>extract_etas_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mod_to_plot,xdata){</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>idata <span class="ot">=</span> xdata <span class="sc">%&gt;%</span></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(ID,<span class="at">.keep_all =</span> T)<span class="sc">%&gt;%</span></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID,AGE,WT, SEX) <span class="sc">%&gt;%</span> </span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SEXF =</span> <span class="fu">if_else</span>(SEX<span class="sc">==</span><span class="dv">1</span>,<span class="st">"Male"</span>, <span class="st">"Female"</span>))</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>etaM <span class="ot">&lt;-</span>  posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"etaM"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(etaM[i,type])<span class="sc">%&gt;%</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">etaM =</span> <span class="fu">log</span>(etaM)) <span class="sc">%&gt;%</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(i,type) <span class="sc">%&gt;%</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">lbInd =</span> <span class="fu">quantile</span>(etaM, <span class="at">probs =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianInd =</span> <span class="fu">quantile</span>(etaM, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanInd =</span> <span class="fu">mean</span>(etaM, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>            <span class="at">ubInd =</span> <span class="fu">quantile</span>(etaM, <span class="at">probs =</span> <span class="fl">0.95</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>    type <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"CL"</span>,</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>    type <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Q"</span>,</span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>    type <span class="sc">==</span> <span class="st">"3"</span> <span class="sc">~</span> <span class="st">"V1"</span>,</span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>    type <span class="sc">==</span> <span class="st">"4"</span> <span class="sc">~</span> <span class="st">"V2"</span>,</span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>    type <span class="sc">==</span> <span class="st">"5"</span> <span class="sc">~</span> <span class="st">"Ka"</span>,</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>    type <span class="sc">==</span> <span class="st">"6"</span> <span class="sc">~</span> <span class="st">"Ka14"</span>,</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>    type <span class="sc">==</span> <span class="st">"7"</span> <span class="sc">~</span> <span class="st">"Ka41"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(idata)</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-data" class="level1">
<h1>Load data</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>eda_figures_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(figures_dir, <span class="st">"EDA"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>eda_tables_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(tables_dir,<span class="st">"EDA"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(eda_figures_dir, <span class="at">recursive =</span> T)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(eda_tables_dir, <span class="at">recursive =</span> T)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>xdata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(data_dir, <span class="st">"nonmem_data_v02.csv"</span>), <span class="at">na.strings=</span><span class="st">'.'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>xdata <span class="ot">&lt;-</span> xdata <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">outliers =</span> OUT,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">infusion =</span> TIMEh<span class="sc">&lt;</span>TINFS,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">timepostinf =</span> TIMEh<span class="sc">-</span>TINFS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="eda" class="level1">
<h1>EDA</h1>
<section id="plot-raw-data" class="level2">
<h2 class="anchored" data-anchor-id="plot-raw-data">Plot raw data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Some plots</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(xdata, EVID <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> outliers<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> infusion<span class="sc">==</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x =</span> TIMEh, <span class="at">y =</span> DV, <span class="at">group =</span> ID)) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(xdata, EVID <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> outliers<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> infusion<span class="sc">==</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x =</span> TIMEh, <span class="at">y =</span> DV, <span class="at">group =</span> ID),<span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x, <span class="at">n=</span><span class="dv">4</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))<span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sufentanil concentrations, pg/ml"</span>) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time after infusion start, h"</span>) <span class="sc">+</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>,<span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="st">"cm"</span>)), </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>plot2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(xdata, EVID <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> outliers<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> infusion<span class="sc">==</span><span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> timepostinf, <span class="at">y =</span> DV, <span class="at">group =</span> ID)) <span class="sc">+</span> </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(xdata, EVID <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> outliers<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> infusion<span class="sc">==</span><span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> timepostinf, <span class="at">y =</span> DV, <span class="at">group =</span> ID),<span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>),</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x, <span class="at">n=</span><span class="dv">4</span>),</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))<span class="sc">+</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a> <span class="fu">ylab</span>(<span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time after infusion end, h"</span>)<span class="sc">+</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>,<span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="st">"cm"</span>)), </span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>))</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>plot12 <span class="ot">&lt;-</span>plot1<span class="sc">+</span>plot2</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>plot2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(xdata, EVID<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> outliers<span class="sc">==</span><span class="dv">0</span>), <span class="fu">aes</span>(<span class="at">x =</span> TIMEh, <span class="at">y =</span> DV, <span class="at">color =</span> <span class="fu">factor</span>(ID)),<span class="at">shape=</span><span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span> </span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">100</span>),</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trans=</span><span class="st">'log10'</span>,</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks=</span><span class="fu">trans_breaks</span>(<span class="st">'log10'</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x, <span class="at">n=</span><span class="dv">4</span>),</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels=</span><span class="fu">trans_format</span>(<span class="st">'log10'</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x)))<span class="sc">+</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Sufentanil concentrations, pg/ml"</span>) <span class="sc">+</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time after infusion start, days"</span>) <span class="sc">+</span> </span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"ID"</span>)<span class="sc">+</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>,<span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="st">"cm"</span>)), </span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">xend =</span> TINFS, <span class="at">yend =</span> <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span><span class="fu">factor</span>(ID),<span class="at">nrow =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(eda_figures_dir, <span class="st">"rawdata1.png"</span>),<span class="at">plot =</span> plot12, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(eda_figures_dir, <span class="st">"rawdata2.png"</span>),<span class="at">plot =</span> plot2, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/plot-raw-data-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/plot-raw-data-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>figure_2<span class="ot">&lt;-</span>plot12</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="patients-demographics" class="level2">
<h2 class="anchored" data-anchor-id="patients-demographics">Patients demographics</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tab1<span class="ot">&lt;-</span>xdata <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(ID,<span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">SEX=</span><span class="fu">case_when</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>             SEX <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Male"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>             SEX <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Female"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">.default =</span> <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, WT, AGE, SEX) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Body Weigh, kg"</span> <span class="ot">=</span> WT, <span class="st">"Age, y"</span> <span class="ot">=</span> AGE, <span class="st">"Sex"</span> <span class="ot">=</span> SEX) </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>tab2<span class="ot">&lt;-</span>xdata <span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(ID,<span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pt_cont_long</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Body Weight, kg"</span> <span class="ot">=</span> <span class="st">"WT"</span>, <span class="st">"Age, y"</span> <span class="ot">=</span> <span class="st">"AGE"</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_new</span>()</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>tab3<span class="ot">&lt;-</span>xdata <span class="sc">%&gt;%</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(ID,<span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">SEX=</span><span class="fu">case_when</span>(</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>             SEX <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"Male"</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>             SEX <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"Female"</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">.default =</span> <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pt_cat_long</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Sex"</span> <span class="ot">=</span> <span class="st">"SEX"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_new</span>()</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(tab1, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(eda_tables_dir, <span class="st">"icov.csv"</span>))</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>tab1<span class="sc">%&gt;%</span>kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ID</th>
<th style="text-align: right;">Body Weigh, kg</th>
<th style="text-align: right;">Age, y</th>
<th style="text-align: left;">Sex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1001</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">44</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="even">
<td style="text-align: right;">1002</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">71</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1003</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="even">
<td style="text-align: right;">1004</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">59</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1005</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="even">
<td style="text-align: right;">1006</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">64</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1007</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">60</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="even">
<td style="text-align: right;">1008</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">35</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1011</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">64</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="even">
<td style="text-align: right;">1014</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1015</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">51</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="even">
<td style="text-align: right;">1016</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">83</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1017</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">46</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="even">
<td style="text-align: right;">1018</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">34</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1019</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">66</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="even">
<td style="text-align: right;">1021</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">63</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1022</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">35</td>
<td style="text-align: left;">Female</td>
</tr>
<tr class="even">
<td style="text-align: right;">1023</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">73</td>
<td style="text-align: left;">Male</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tab2<span class="sc">$</span>data<span class="sc">%&gt;%</span> kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">n</th>
<th style="text-align: left;">Mean</th>
<th style="text-align: left;">Median</th>
<th style="text-align: left;">SD</th>
<th style="text-align: left;">Min / Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Body Weight, kg</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">69.1</td>
<td style="text-align: left;">70.5</td>
<td style="text-align: left;">14.2</td>
<td style="text-align: left;">45 / 96</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age, y</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">53.4</td>
<td style="text-align: left;">55.0</td>
<td style="text-align: left;">15.4</td>
<td style="text-align: left;">34 / 83</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tab3<span class="sc">$</span>data<span class="sc">%&gt;%</span> kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">level</th>
<th style="text-align: left;">Summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sex</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">7 (38.9)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">11 (61.1)</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="stan" class="level1">
<h1>Stan</h1>
</section>
<section id="m1-2cmp-disposition-model-1-comp-abs" class="level1">
<h1>M1: 2cmp disposition model + 1 comp abs</h1>
<p><span class="math display">\[
\begin{aligned}
&amp; \frac{dA}{dt} = - KA \cdot  A \\
&amp; V_1 \cdot \frac{dC_1}{dt} =  KA \cdot  A - CL \cdot  C_1 - Q \cdot  C_1 + Q \cdot  C_2 \\
&amp; V_2 \cdot \frac{dC_2}{dt} =  Q \cdot  C1 - Q \cdot  C_2
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_2\)</span> denote sufentanil concentrations in plasma and peripheral compartment. <span class="math inline">\(KA\)</span> denotes sufentanil absorption rate constant. The statistical model has the following structure (hierarchical model)</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \log C_{Obs_{i,j}} \sim student\_t(\nu,f(P_{i},t_{i,j}),\sigma) \\
&amp; \log P_{i} \sim \text{MVN}(\log \theta_P , \Omega) \\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(P_i=(CL_{i}, Q_{i}, V1_{i}, V2_{i}, KA_{i})\)</span> is a vector of subject-specific parameters, <span class="math inline">\(f(.)\)</span> corresponds to the above ODE equations, <span class="math inline">\(MVN\)</span> is a multivariate normal distribution, <span class="math inline">\(\theta_P\)</span> is a vector of typical values of <span class="math inline">\(P_i\)</span>. In turn, <span class="math inline">\(\sigma\)</span> is the scale and <span class="math inline">\(\Omega\)</span> is the scale matrix for the random effects related to the residual and unexplained between-subject variability. For convenience <span class="math inline">\(\Omega\)</span> was decomposed to:</p>
<p><span class="math display">\[
\Omega = diag(\omega) \cdot LL' \cdot diag(\omega)
\]</span></p>
<p>where <span class="math inline">\(\rho = LL'\)</span> denotes correlation, <span class="math inline">\(L\)</span> is a lower triangular Cholesky factor for a correlation matrix and <span class="math inline">\(\omega\)</span> denotes standard deviation for between subject variability.</p>
<p>The priors were specified based on parameter estimates provided by our previous work <span class="citation" data-cites="Bartkowska-Sniatkowska2016-hm">(<a href="#ref-Bartkowska-Sniatkowska2016-hm" role="doc-biblioref">Bartkowska-Śniatkowska <em>et al.</em>, 2016</a>)</span> <span class="math display">\[
\begin{aligned}
&amp; \theta_{CL} \sim lognormal(log(45.3),0.25), \\
&amp; \theta_{Q}  \sim lognormal(log(38.3),0.25), \\
&amp; \theta_{V1} \sim lognormal(log(7.90),0.25), \\
&amp; \theta_{V2} \sim lognormal(log(481),0.25), \\
&amp; \theta_{KA} \sim lognormal(log(1),0.50), \\
&amp; \nu \sim gamma(2,0.1),\\
&amp; \omega_{P}\sim lognormal(log(0.4),0.25), \\
&amp; \sigma \sim lognormal(log(0.2),0.25), \\
&amp; L \sim  LKJ(5)
\end{aligned}
\]</span></p>
<p>LKJ(5) ensure that the density is uniform over correlation matrices of order 4</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">new_model</span>(<span class="fu">file.path</span>(model_dir, <span class="st">"0"</span>), <span class="at">.model_type =</span> <span class="st">"stan"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#open_standata_file(mod0)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#check_stan_model(mod0)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#mod0 &lt;- mod0 %&gt;% submit_model(.overwrite = TRUE) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mod1  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(<span class="fu">file.path</span>(model_dir, <span class="st">"1"</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#open_standata_file(mod1)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#check_stan_model(mod1)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>mod1_res <span class="ot">&lt;-</span> mod1 <span class="sc">%&gt;%</span> <span class="fu">submit_model</span>(<span class="at">.overwrite =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="run-stan" class="level2">
<h2 class="anchored" data-anchor-id="run-stan">Run stan</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="ot">=</span> <span class="st">"1"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>model_figures_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(figures_dir, model_name)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>model_tables_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(tables_dir,model_name)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(model_figures_dir, <span class="at">recursive =</span> T)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(model_tables_dir, <span class="at">recursive =</span> T)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>mod1  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(here<span class="sc">::</span><span class="fu">here</span>(model_dir, model_name))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>mod_to_plot <span class="ot">&lt;-</span> <span class="fu">read_fit_model</span>(mod1)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>xdata <span class="ot">&lt;-</span> xdata <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(OUT<span class="sc">!=</span><span class="dv">1</span>, CMT<span class="sc">!=</span><span class="dv">22</span>, CMT<span class="sc">!=</span><span class="dv">33</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TIME =</span> <span class="fu">if_else</span>(infusion<span class="sc">==</span><span class="dv">0</span>,timepostinf,TIMEh))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>loo1 <span class="ot">=</span> mod_to_plot<span class="sc">$</span><span class="fu">loo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="parameters" class="level2">
<h2 class="anchored" data-anchor-id="parameters">Parameters</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lp__"</span>, <span class="st">"CLHat"</span>, <span class="st">"QHat"</span>, <span class="st">"V1Hat"</span>, <span class="st">"V2Hat"</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">"KAHat"</span>,<span class="st">"omega"</span>, <span class="st">"sigma"</span>,<span class="st">"nu"</span>,<span class="st">"rho"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>ptable <span class="ot">&lt;-</span><span class="fu">plot_param_tables</span>(mod_to_plot, pars)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ptable<span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 21%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">parameter</th>
<th style="text-align: left;">mean</th>
<th style="text-align: left;">median</th>
<th style="text-align: left;">sd</th>
<th style="text-align: left;">mad</th>
<th style="text-align: left;">90% CI</th>
<th style="text-align: left;">ess_bulk</th>
<th style="text-align: left;">ess_tail</th>
<th style="text-align: left;">rhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lp__</td>
<td style="text-align: left;">-134</td>
<td style="text-align: left;">-133</td>
<td style="text-align: left;">10.2</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">(-151, -118)</td>
<td style="text-align: left;">717</td>
<td style="text-align: left;">1.26e+03</td>
<td style="text-align: left;">1.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">CLHat</td>
<td style="text-align: left;">67.9</td>
<td style="text-align: left;">67.3</td>
<td style="text-align: left;">10.7</td>
<td style="text-align: left;">10.5</td>
<td style="text-align: left;">(51.8, 86.7)</td>
<td style="text-align: left;">833</td>
<td style="text-align: left;">1.77e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QHat</td>
<td style="text-align: left;">112</td>
<td style="text-align: left;">109</td>
<td style="text-align: left;">30.2</td>
<td style="text-align: left;">28.5</td>
<td style="text-align: left;">(70.1, 167)</td>
<td style="text-align: left;">1.64e+03</td>
<td style="text-align: left;">2.07e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">V1Hat</td>
<td style="text-align: left;">7.18</td>
<td style="text-align: left;">7.03</td>
<td style="text-align: left;">1.66</td>
<td style="text-align: left;">1.62</td>
<td style="text-align: left;">(4.78, 10.2)</td>
<td style="text-align: left;">4.28e+03</td>
<td style="text-align: left;">2.81e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V2Hat</td>
<td style="text-align: left;">1.28e+03</td>
<td style="text-align: left;">1.27e+03</td>
<td style="text-align: left;">282</td>
<td style="text-align: left;">277</td>
<td style="text-align: left;">( 863, 1.78e+03)</td>
<td style="text-align: left;">1.48e+03</td>
<td style="text-align: left;">2.21e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">KAHat</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">0.998</td>
<td style="text-align: left;">0.415</td>
<td style="text-align: left;">0.359</td>
<td style="text-align: left;">(0.548, 1.82)</td>
<td style="text-align: left;">1.2e+03</td>
<td style="text-align: left;">1.82e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[1]</td>
<td style="text-align: left;">0.535</td>
<td style="text-align: left;">0.527</td>
<td style="text-align: left;">0.0839</td>
<td style="text-align: left;">0.081</td>
<td style="text-align: left;">(0.417, 0.688)</td>
<td style="text-align: left;">1.44e+03</td>
<td style="text-align: left;">2.47e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">omega[2]</td>
<td style="text-align: left;">0.974</td>
<td style="text-align: left;">0.961</td>
<td style="text-align: left;">0.189</td>
<td style="text-align: left;">0.178</td>
<td style="text-align: left;">(0.691, 1.3)</td>
<td style="text-align: left;">1e+03</td>
<td style="text-align: left;">1.96e+03</td>
<td style="text-align: left;">1.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[3]</td>
<td style="text-align: left;">0.412</td>
<td style="text-align: left;">0.4</td>
<td style="text-align: left;">0.105</td>
<td style="text-align: left;">0.101</td>
<td style="text-align: left;">(0.263, 0.603)</td>
<td style="text-align: left;">5.78e+03</td>
<td style="text-align: left;">3.26e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">omega[4]</td>
<td style="text-align: left;">0.679</td>
<td style="text-align: left;">0.671</td>
<td style="text-align: left;">0.135</td>
<td style="text-align: left;">0.138</td>
<td style="text-align: left;">(0.475, 0.917)</td>
<td style="text-align: left;">1.58e+03</td>
<td style="text-align: left;">2.63e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[5]</td>
<td style="text-align: left;">1.4</td>
<td style="text-align: left;">1.39</td>
<td style="text-align: left;">0.179</td>
<td style="text-align: left;">0.181</td>
<td style="text-align: left;">(1.12, 1.71)</td>
<td style="text-align: left;">1.33e+03</td>
<td style="text-align: left;">2.06e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma</td>
<td style="text-align: left;">0.308</td>
<td style="text-align: left;">0.306</td>
<td style="text-align: left;">0.0291</td>
<td style="text-align: left;">0.0287</td>
<td style="text-align: left;">(0.264, 0.36)</td>
<td style="text-align: left;">1.66e+03</td>
<td style="text-align: left;">2.69e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nu</td>
<td style="text-align: left;">3.83</td>
<td style="text-align: left;">3.55</td>
<td style="text-align: left;">0.986</td>
<td style="text-align: left;">0.575</td>
<td style="text-align: left;">(3.04, 5.52)</td>
<td style="text-align: left;">2.58e+03</td>
<td style="text-align: left;">2.05e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[2,1]</td>
<td style="text-align: left;">-0.0545</td>
<td style="text-align: left;">-0.0551</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">(-0.382, 0.264)</td>
<td style="text-align: left;">1.01e+03</td>
<td style="text-align: left;">1.74e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[3,1]</td>
<td style="text-align: left;">0.00954</td>
<td style="text-align: left;">0.013</td>
<td style="text-align: left;">0.202</td>
<td style="text-align: left;">0.204</td>
<td style="text-align: left;">(-0.335, 0.341)</td>
<td style="text-align: left;">4.32e+03</td>
<td style="text-align: left;">3.18e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[4,1]</td>
<td style="text-align: left;">0.00363</td>
<td style="text-align: left;">-0.000333</td>
<td style="text-align: left;">0.18</td>
<td style="text-align: left;">0.178</td>
<td style="text-align: left;">(-0.291, 0.309)</td>
<td style="text-align: left;">1.08e+03</td>
<td style="text-align: left;">2.33e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,1]</td>
<td style="text-align: left;">-0.303</td>
<td style="text-align: left;">-0.307</td>
<td style="text-align: left;">0.137</td>
<td style="text-align: left;">0.139</td>
<td style="text-align: left;">(-0.523, -0.0601)</td>
<td style="text-align: left;">2.25e+03</td>
<td style="text-align: left;">2.78e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,2]</td>
<td style="text-align: left;">-0.0545</td>
<td style="text-align: left;">-0.0551</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">(-0.382, 0.264)</td>
<td style="text-align: left;">1.01e+03</td>
<td style="text-align: left;">1.74e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[3,2]</td>
<td style="text-align: left;">-0.055</td>
<td style="text-align: left;">-0.0583</td>
<td style="text-align: left;">0.203</td>
<td style="text-align: left;">0.21</td>
<td style="text-align: left;">(-0.384, 0.282)</td>
<td style="text-align: left;">4.54e+03</td>
<td style="text-align: left;">2.94e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[4,2]</td>
<td style="text-align: left;">0.394</td>
<td style="text-align: left;">0.402</td>
<td style="text-align: left;">0.14</td>
<td style="text-align: left;">0.138</td>
<td style="text-align: left;">(0.153, 0.616)</td>
<td style="text-align: left;">2.5e+03</td>
<td style="text-align: left;">2.75e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,2]</td>
<td style="text-align: left;">0.343</td>
<td style="text-align: left;">0.349</td>
<td style="text-align: left;">0.149</td>
<td style="text-align: left;">0.152</td>
<td style="text-align: left;">(0.0859, 0.578)</td>
<td style="text-align: left;">1.43e+03</td>
<td style="text-align: left;">2.81e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,3]</td>
<td style="text-align: left;">0.00954</td>
<td style="text-align: left;">0.013</td>
<td style="text-align: left;">0.202</td>
<td style="text-align: left;">0.204</td>
<td style="text-align: left;">(-0.335, 0.341)</td>
<td style="text-align: left;">4.32e+03</td>
<td style="text-align: left;">3.18e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,3]</td>
<td style="text-align: left;">-0.055</td>
<td style="text-align: left;">-0.0583</td>
<td style="text-align: left;">0.203</td>
<td style="text-align: left;">0.21</td>
<td style="text-align: left;">(-0.384, 0.282)</td>
<td style="text-align: left;">4.54e+03</td>
<td style="text-align: left;">2.94e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[4,3]</td>
<td style="text-align: left;">-0.0139</td>
<td style="text-align: left;">-0.0153</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.205</td>
<td style="text-align: left;">(-0.338, 0.317)</td>
<td style="text-align: left;">1.91e+03</td>
<td style="text-align: left;">2.79e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,3]</td>
<td style="text-align: left;">-0.0494</td>
<td style="text-align: left;">-0.0535</td>
<td style="text-align: left;">0.205</td>
<td style="text-align: left;">0.207</td>
<td style="text-align: left;">(-0.381, 0.291)</td>
<td style="text-align: left;">1.59e+03</td>
<td style="text-align: left;">2.49e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,4]</td>
<td style="text-align: left;">0.00363</td>
<td style="text-align: left;">-0.000333</td>
<td style="text-align: left;">0.18</td>
<td style="text-align: left;">0.178</td>
<td style="text-align: left;">(-0.291, 0.309)</td>
<td style="text-align: left;">1.08e+03</td>
<td style="text-align: left;">2.33e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,4]</td>
<td style="text-align: left;">0.394</td>
<td style="text-align: left;">0.402</td>
<td style="text-align: left;">0.14</td>
<td style="text-align: left;">0.138</td>
<td style="text-align: left;">(0.153, 0.616)</td>
<td style="text-align: left;">2.5e+03</td>
<td style="text-align: left;">2.75e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[3,4]</td>
<td style="text-align: left;">-0.0139</td>
<td style="text-align: left;">-0.0153</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.205</td>
<td style="text-align: left;">(-0.338, 0.317)</td>
<td style="text-align: left;">1.91e+03</td>
<td style="text-align: left;">2.79e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,4]</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">0.15</td>
<td style="text-align: left;">0.153</td>
<td style="text-align: left;">(-0.0603, 0.435)</td>
<td style="text-align: left;">2.05e+03</td>
<td style="text-align: left;">2.6e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,5]</td>
<td style="text-align: left;">-0.303</td>
<td style="text-align: left;">-0.307</td>
<td style="text-align: left;">0.137</td>
<td style="text-align: left;">0.139</td>
<td style="text-align: left;">(-0.523, -0.0601)</td>
<td style="text-align: left;">2.25e+03</td>
<td style="text-align: left;">2.78e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,5]</td>
<td style="text-align: left;">0.343</td>
<td style="text-align: left;">0.349</td>
<td style="text-align: left;">0.149</td>
<td style="text-align: left;">0.152</td>
<td style="text-align: left;">(0.0859, 0.578)</td>
<td style="text-align: left;">1.43e+03</td>
<td style="text-align: left;">2.81e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[3,5]</td>
<td style="text-align: left;">-0.0494</td>
<td style="text-align: left;">-0.0535</td>
<td style="text-align: left;">0.205</td>
<td style="text-align: left;">0.207</td>
<td style="text-align: left;">(-0.381, 0.291)</td>
<td style="text-align: left;">1.59e+03</td>
<td style="text-align: left;">2.49e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[4,5]</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">0.15</td>
<td style="text-align: left;">0.153</td>
<td style="text-align: left;">(-0.0603, 0.435)</td>
<td style="text-align: left;">2.05e+03</td>
<td style="text-align: left;">2.6e+03</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(knitr<span class="sc">::</span><span class="fu">kable</span>(ptable <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">select</span>(<span class="sc">-</span>mad,<span class="sc">-</span>ess_bulk,<span class="sc">-</span>ess_tail) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter</span>(<span class="fu">str_detect</span>(parameter,<span class="st">"rho"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)), <span class="at">format =</span> <span class="st">"latex"</span>),  </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>           here<span class="sc">::</span><span class="fu">here</span>(model_tables_dir, <span class="st">"parameters-table.tex"</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ptable, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(model_tables_dir, <span class="st">"parameters-table.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="trace-plots" class="level2">
<h2 class="anchored" data-anchor-id="trace-plots">Trace plots</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lp__"</span>, <span class="st">"CLHat"</span>, <span class="st">"QHat"</span>, <span class="st">"V1Hat"</span>, <span class="st">"V2Hat"</span>,<span class="st">"KAHat"</span>,<span class="st">"omega"</span>, <span class="st">"sigma"</span>, <span class="st">"nu"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens_overlay</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/trace-plots-mod1-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/trace-plots-mod1-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"trace-plots.png"</span>),<span class="at">plot =</span> p1, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"dense-plots.png"</span>),<span class="at">plot =</span> p2, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="individual-and-population-predictions" class="level2">
<h2 class="anchored" data-anchor-id="individual-and-population-predictions">Individual and population predictions</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ppc1 <span class="ot">&lt;-</span> <span class="fu">pred_by_id_fun</span>(mod_to_plot, xdata)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ppc1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/IPRED-PRED-mod1-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"pred-by-id.png"</span>),<span class="at">plot =</span> ppc1, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="vpc" class="level2">
<h2 class="anchored" data-anchor-id="vpc">VPC</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>vpc_plot<span class="ot">&lt;-</span><span class="fu">vpc_fun</span>(mod_to_plot, xdata)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>vpc_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/VPC-mod1-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"vpc.png"</span>),<span class="at">plot =</span> vpc_plot, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>figure_4a<span class="ot">&lt;-</span>vpc_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="gof" class="level2">
<h2 class="anchored" data-anchor-id="gof">GOF</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plot_gof <span class="ot">&lt;-</span><span class="fu">gof_fun</span>(mod_to_plot, xdata)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plot_gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/GOF-mod1-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"gof.png"</span>),<span class="at">plot =</span> plot_gof, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="individual-parameters-vs.-covariates" class="level2">
<h2 class="anchored" data-anchor-id="individual-parameters-vs.-covariates">Individual parameters vs.&nbsp;covariates</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>etaM<span class="ot">&lt;-</span><span class="fu">extract_etas_fun</span>(mod_to_plot,xdata)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>cont_cov <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"AGE//Age,y"</span>,<span class="st">"WT//Body Weight, kg"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>cat_cov <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"SEXF//Sex"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">map</span>(cont_cov, \(x) <span class="fu">fun_cont_cov</span>(x,etaM))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">map</span>(cat_cov, \(x) <span class="fu">fun_cat_cov</span>(x,etaM))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">c</span>(p1,p2)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/covariets-mod1-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/covariets-mod1-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/covariets-mod1-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(plots), \(x) <span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                                 glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"cov-plots-{x}.png"</span>)),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">plot =</span> plots[[x]], </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "C:/Users/GUMed/Documents/PKPDprojects/sufentanil_epidural/deliv/figures/torsten/1/cov-plots-1.png"

[[2]]
[1] "C:/Users/GUMed/Documents/PKPDprojects/sufentanil_epidural/deliv/figures/torsten/1/cov-plots-2.png"

[[3]]
[1] "C:/Users/GUMed/Documents/PKPDprojects/sufentanil_epidural/deliv/figures/torsten/1/cov-plots-3.png"</code></pre>
</div>
</div>
</section>
</section>
<section id="m3-2cmp-model-2cmp-absorption" class="level1">
<h1>M3: 2cmp model + 2cmp absorption</h1>
<p><span class="math display">\[
\begin{aligned}
&amp; \frac{dA1}{dt} = - KA \cdot  A1 - KA14 \cdot  A1 + KA41 \cdot  A4 \\
&amp; \frac{dA4}{dt} =  KA14 \cdot  A1 - KA41 \cdot  A4 \\
&amp; V_1 \cdot \frac{dC_1}{dt} =  KA \cdot  A1 - CL \cdot  C_1 - Q \cdot  C_1 + Q \cdot  C_2 \\
&amp; V_2 \cdot \frac{dC_2}{dt} =  Q \cdot  C1 - Q \cdot  C_2
\end{aligned}
\]</span> <span class="math display">\[
\begin{aligned}
&amp; \theta_{KA} \sim lognormal(log(4.85),0.50), \\
&amp; \theta_{KA14} \sim lognormal(log(4.85),0.50), \\
&amp; \theta_{KA41} \sim lognormal(log(0.080),0.50), \\
\end{aligned}
\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mod3  &lt;- read_model(file.path(model_dir, "3"))</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mod3b &lt;- copy_model_from(mod3, "3b", "broader priors",.overwrite=T)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>mod3b  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(<span class="fu">file.path</span>(model_dir, <span class="st">"3b"</span>))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>mod3b_res <span class="ot">&lt;-</span> mod3b <span class="sc">%&gt;%</span> <span class="fu">submit_model</span>(<span class="at">.overwrite =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="run-stan-1" class="level2">
<h2 class="anchored" data-anchor-id="run-stan-1">Run stan</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="ot">=</span> <span class="st">"3b"</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>model_figures_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(figures_dir, model_name)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>model_tables_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(tables_dir,model_name)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(model_figures_dir, <span class="at">recursive =</span> T)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(model_tables_dir, <span class="at">recursive =</span> T)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>mod2  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(here<span class="sc">::</span><span class="fu">here</span>(model_dir, model_name))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>mod_to_plot <span class="ot">&lt;-</span> <span class="fu">read_fit_model</span>(mod2)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>xdata <span class="ot">&lt;-</span> xdata <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(OUT<span class="sc">!=</span><span class="dv">1</span>, CMT<span class="sc">!=</span><span class="dv">22</span>, CMT<span class="sc">!=</span><span class="dv">33</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TIME =</span> <span class="fu">if_else</span>(infusion<span class="sc">==</span><span class="dv">0</span>,timepostinf,TIMEh))</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>loo3 <span class="ot">=</span> mod_to_plot<span class="sc">$</span><span class="fu">loo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="parameters-1" class="level2">
<h2 class="anchored" data-anchor-id="parameters-1">Parameters</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lp__"</span>, <span class="st">"CLHat"</span>, <span class="st">"QHat"</span>, <span class="st">"V1Hat"</span>, <span class="st">"V2Hat"</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">"KAHat"</span>, <span class="st">"KA14Hat"</span>, <span class="st">"KA41Hat"</span>, <span class="st">"omega"</span>, <span class="st">"sigma"</span>,<span class="st">"nu"</span>,<span class="st">"rho"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>ptable <span class="ot">&lt;-</span><span class="fu">plot_param_tables</span>(mod_to_plot, pars)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>ptable<span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 20%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">parameter</th>
<th style="text-align: left;">mean</th>
<th style="text-align: left;">median</th>
<th style="text-align: left;">sd</th>
<th style="text-align: left;">mad</th>
<th style="text-align: left;">90% CI</th>
<th style="text-align: left;">ess_bulk</th>
<th style="text-align: left;">ess_tail</th>
<th style="text-align: left;">rhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lp__</td>
<td style="text-align: left;">-131</td>
<td style="text-align: left;">-131</td>
<td style="text-align: left;">10.6</td>
<td style="text-align: left;">10.5</td>
<td style="text-align: left;">(-150, -115)</td>
<td style="text-align: left;">1.14e+03</td>
<td style="text-align: left;">2.09e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">CLHat</td>
<td style="text-align: left;">64.9</td>
<td style="text-align: left;">64.5</td>
<td style="text-align: left;">7.85</td>
<td style="text-align: left;">7.45</td>
<td style="text-align: left;">(52.4, 78.2)</td>
<td style="text-align: left;">1.03e+03</td>
<td style="text-align: left;">1.81e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QHat</td>
<td style="text-align: left;">48.2</td>
<td style="text-align: left;">47.1</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">10.1</td>
<td style="text-align: left;">(32.5, 68.5)</td>
<td style="text-align: left;">3.86e+03</td>
<td style="text-align: left;">3.11e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">V1Hat</td>
<td style="text-align: left;">10.2</td>
<td style="text-align: left;">9.97</td>
<td style="text-align: left;">2.4</td>
<td style="text-align: left;">2.4</td>
<td style="text-align: left;">(6.72, 14.4)</td>
<td style="text-align: left;">3.51e+03</td>
<td style="text-align: left;">2.82e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V2Hat</td>
<td style="text-align: left;">506</td>
<td style="text-align: left;">495</td>
<td style="text-align: left;">110</td>
<td style="text-align: left;">106</td>
<td style="text-align: left;">( 345, 700)</td>
<td style="text-align: left;">2.76e+03</td>
<td style="text-align: left;">2.38e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">KAHat</td>
<td style="text-align: left;">3.27</td>
<td style="text-align: left;">3.13</td>
<td style="text-align: left;">0.901</td>
<td style="text-align: left;">0.834</td>
<td style="text-align: left;">(2.04, 4.98)</td>
<td style="text-align: left;">2.47e+03</td>
<td style="text-align: left;">2.25e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KA14Hat</td>
<td style="text-align: left;">14.9</td>
<td style="text-align: left;">14.3</td>
<td style="text-align: left;">4.03</td>
<td style="text-align: left;">3.72</td>
<td style="text-align: left;">(9.33, 22.4)</td>
<td style="text-align: left;">2.51e+03</td>
<td style="text-align: left;">2.13e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">KA41Hat</td>
<td style="text-align: left;">0.135</td>
<td style="text-align: left;">0.134</td>
<td style="text-align: left;">0.0229</td>
<td style="text-align: left;">0.0228</td>
<td style="text-align: left;">(0.0987, 0.175)</td>
<td style="text-align: left;">2.44e+03</td>
<td style="text-align: left;">2.73e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[1]</td>
<td style="text-align: left;">0.49</td>
<td style="text-align: left;">0.482</td>
<td style="text-align: left;">0.0734</td>
<td style="text-align: left;">0.0698</td>
<td style="text-align: left;">(0.383, 0.623)</td>
<td style="text-align: left;">1.76e+03</td>
<td style="text-align: left;">2.48e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">omega[2]</td>
<td style="text-align: left;">0.448</td>
<td style="text-align: left;">0.433</td>
<td style="text-align: left;">0.115</td>
<td style="text-align: left;">0.111</td>
<td style="text-align: left;">(0.286, 0.653)</td>
<td style="text-align: left;">3.97e+03</td>
<td style="text-align: left;">2.97e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[3]</td>
<td style="text-align: left;">1.51</td>
<td style="text-align: left;">1.5</td>
<td style="text-align: left;">0.225</td>
<td style="text-align: left;">0.228</td>
<td style="text-align: left;">(1.13, 1.88)</td>
<td style="text-align: left;">1.38e+03</td>
<td style="text-align: left;">1.91e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">omega[4]</td>
<td style="text-align: left;">0.408</td>
<td style="text-align: left;">0.393</td>
<td style="text-align: left;">0.107</td>
<td style="text-align: left;">0.099</td>
<td style="text-align: left;">(0.26, 0.609)</td>
<td style="text-align: left;">3.21e+03</td>
<td style="text-align: left;">2.05e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[5]</td>
<td style="text-align: left;">0.362</td>
<td style="text-align: left;">0.355</td>
<td style="text-align: left;">0.0822</td>
<td style="text-align: left;">0.0788</td>
<td style="text-align: left;">(0.241, 0.504)</td>
<td style="text-align: left;">2.9e+03</td>
<td style="text-align: left;">2.91e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">omega[6]</td>
<td style="text-align: left;">0.384</td>
<td style="text-align: left;">0.373</td>
<td style="text-align: left;">0.0864</td>
<td style="text-align: left;">0.0821</td>
<td style="text-align: left;">(0.259, 0.546)</td>
<td style="text-align: left;">2.47e+03</td>
<td style="text-align: left;">2.88e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[7]</td>
<td style="text-align: left;">0.502</td>
<td style="text-align: left;">0.496</td>
<td style="text-align: left;">0.112</td>
<td style="text-align: left;">0.112</td>
<td style="text-align: left;">(0.331, 0.702)</td>
<td style="text-align: left;">2.07e+03</td>
<td style="text-align: left;">2.37e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma</td>
<td style="text-align: left;">0.307</td>
<td style="text-align: left;">0.305</td>
<td style="text-align: left;">0.027</td>
<td style="text-align: left;">0.0261</td>
<td style="text-align: left;">(0.266, 0.354)</td>
<td style="text-align: left;">2.52e+03</td>
<td style="text-align: left;">3.03e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nu</td>
<td style="text-align: left;">3.81</td>
<td style="text-align: left;">3.55</td>
<td style="text-align: left;">0.862</td>
<td style="text-align: left;">0.559</td>
<td style="text-align: left;">(3.04, 5.44)</td>
<td style="text-align: left;">2.16e+03</td>
<td style="text-align: left;">1.96e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[2,1]</td>
<td style="text-align: left;">0.0315</td>
<td style="text-align: left;">0.0315</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">(-0.285, 0.353)</td>
<td style="text-align: left;">5.03e+03</td>
<td style="text-align: left;">3.12e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[3,1]</td>
<td style="text-align: left;">0.253</td>
<td style="text-align: left;">0.258</td>
<td style="text-align: left;">0.138</td>
<td style="text-align: left;">0.138</td>
<td style="text-align: left;">(0.0202, 0.476)</td>
<td style="text-align: left;">1.89e+03</td>
<td style="text-align: left;">2.14e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[4,1]</td>
<td style="text-align: left;">-0.018</td>
<td style="text-align: left;">-0.0142</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">(-0.331, 0.293)</td>
<td style="text-align: left;">5.47e+03</td>
<td style="text-align: left;">3.1e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,1]</td>
<td style="text-align: left;">-0.0125</td>
<td style="text-align: left;">-0.0163</td>
<td style="text-align: left;">0.189</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">(-0.315, 0.305)</td>
<td style="text-align: left;">4.01e+03</td>
<td style="text-align: left;">3.09e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[6,1]</td>
<td style="text-align: left;">0.025</td>
<td style="text-align: left;">0.0266</td>
<td style="text-align: left;">0.186</td>
<td style="text-align: left;">0.188</td>
<td style="text-align: left;">(-0.287, 0.329)</td>
<td style="text-align: left;">3.96e+03</td>
<td style="text-align: left;">2.93e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,1]</td>
<td style="text-align: left;">0.187</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">0.165</td>
<td style="text-align: left;">0.166</td>
<td style="text-align: left;">(-0.0946, 0.45)</td>
<td style="text-align: left;">3.29e+03</td>
<td style="text-align: left;">2.79e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,2]</td>
<td style="text-align: left;">0.0315</td>
<td style="text-align: left;">0.0315</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">(-0.285, 0.353)</td>
<td style="text-align: left;">5.03e+03</td>
<td style="text-align: left;">3.12e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[3,2]</td>
<td style="text-align: left;">-0.0422</td>
<td style="text-align: left;">-0.0447</td>
<td style="text-align: left;">0.187</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">(-0.354, 0.26)</td>
<td style="text-align: left;">1.7e+03</td>
<td style="text-align: left;">2.41e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[4,2]</td>
<td style="text-align: left;">0.00239</td>
<td style="text-align: left;">0.00736</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">(-0.325, 0.318)</td>
<td style="text-align: left;">5.14e+03</td>
<td style="text-align: left;">2.98e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,2]</td>
<td style="text-align: left;">0.0184</td>
<td style="text-align: left;">0.0196</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">(-0.303, 0.344)</td>
<td style="text-align: left;">4.33e+03</td>
<td style="text-align: left;">3.41e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[6,2]</td>
<td style="text-align: left;">0.0203</td>
<td style="text-align: left;">0.0192</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">(-0.305, 0.343)</td>
<td style="text-align: left;">3.08e+03</td>
<td style="text-align: left;">2.99e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,2]</td>
<td style="text-align: left;">0.106</td>
<td style="text-align: left;">0.113</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">(-0.215, 0.413)</td>
<td style="text-align: left;">2.48e+03</td>
<td style="text-align: left;">2.91e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,3]</td>
<td style="text-align: left;">0.253</td>
<td style="text-align: left;">0.258</td>
<td style="text-align: left;">0.138</td>
<td style="text-align: left;">0.138</td>
<td style="text-align: left;">(0.0202, 0.476)</td>
<td style="text-align: left;">1.89e+03</td>
<td style="text-align: left;">2.14e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,3]</td>
<td style="text-align: left;">-0.0422</td>
<td style="text-align: left;">-0.0447</td>
<td style="text-align: left;">0.187</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">(-0.354, 0.26)</td>
<td style="text-align: left;">1.7e+03</td>
<td style="text-align: left;">2.41e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[4,3]</td>
<td style="text-align: left;">-0.0451</td>
<td style="text-align: left;">-0.0478</td>
<td style="text-align: left;">0.189</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">(-0.359, 0.269)</td>
<td style="text-align: left;">4.66e+03</td>
<td style="text-align: left;">3.11e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,3]</td>
<td style="text-align: left;">0.00317</td>
<td style="text-align: left;">0.00429</td>
<td style="text-align: left;">0.186</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">(-0.298, 0.308)</td>
<td style="text-align: left;">3.35e+03</td>
<td style="text-align: left;">2.98e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[6,3]</td>
<td style="text-align: left;">-0.0955</td>
<td style="text-align: left;">-0.097</td>
<td style="text-align: left;">0.177</td>
<td style="text-align: left;">0.178</td>
<td style="text-align: left;">(-0.393, 0.198)</td>
<td style="text-align: left;">2.72e+03</td>
<td style="text-align: left;">2.65e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,3]</td>
<td style="text-align: left;">0.111</td>
<td style="text-align: left;">0.113</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.164</td>
<td style="text-align: left;">(-0.156, 0.37)</td>
<td style="text-align: left;">3.04e+03</td>
<td style="text-align: left;">2.53e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,4]</td>
<td style="text-align: left;">-0.018</td>
<td style="text-align: left;">-0.0142</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">(-0.331, 0.293)</td>
<td style="text-align: left;">5.47e+03</td>
<td style="text-align: left;">3.1e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,4]</td>
<td style="text-align: left;">0.00239</td>
<td style="text-align: left;">0.00736</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">(-0.325, 0.318)</td>
<td style="text-align: left;">5.14e+03</td>
<td style="text-align: left;">2.98e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[3,4]</td>
<td style="text-align: left;">-0.0451</td>
<td style="text-align: left;">-0.0478</td>
<td style="text-align: left;">0.189</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">(-0.359, 0.269)</td>
<td style="text-align: left;">4.66e+03</td>
<td style="text-align: left;">3.11e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,4]</td>
<td style="text-align: left;">0.0258</td>
<td style="text-align: left;">0.0259</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">0.205</td>
<td style="text-align: left;">(-0.293, 0.342)</td>
<td style="text-align: left;">3.02e+03</td>
<td style="text-align: left;">3.25e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[6,4]</td>
<td style="text-align: left;">-0.024</td>
<td style="text-align: left;">-0.0256</td>
<td style="text-align: left;">0.201</td>
<td style="text-align: left;">0.202</td>
<td style="text-align: left;">(-0.358, 0.314)</td>
<td style="text-align: left;">3.27e+03</td>
<td style="text-align: left;">2.86e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,4]</td>
<td style="text-align: left;">-0.0355</td>
<td style="text-align: left;">-0.0391</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.201</td>
<td style="text-align: left;">(-0.354, 0.287)</td>
<td style="text-align: left;">2.75e+03</td>
<td style="text-align: left;">3.1e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,5]</td>
<td style="text-align: left;">-0.0125</td>
<td style="text-align: left;">-0.0163</td>
<td style="text-align: left;">0.189</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">(-0.315, 0.305)</td>
<td style="text-align: left;">4.01e+03</td>
<td style="text-align: left;">3.09e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,5]</td>
<td style="text-align: left;">0.0184</td>
<td style="text-align: left;">0.0196</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">(-0.303, 0.344)</td>
<td style="text-align: left;">4.33e+03</td>
<td style="text-align: left;">3.41e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[3,5]</td>
<td style="text-align: left;">0.00317</td>
<td style="text-align: left;">0.00429</td>
<td style="text-align: left;">0.186</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">(-0.298, 0.308)</td>
<td style="text-align: left;">3.35e+03</td>
<td style="text-align: left;">2.98e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[4,5]</td>
<td style="text-align: left;">0.0258</td>
<td style="text-align: left;">0.0259</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">0.205</td>
<td style="text-align: left;">(-0.293, 0.342)</td>
<td style="text-align: left;">3.02e+03</td>
<td style="text-align: left;">3.25e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[6,5]</td>
<td style="text-align: left;">0.0758</td>
<td style="text-align: left;">0.0771</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">0.203</td>
<td style="text-align: left;">(-0.249, 0.391)</td>
<td style="text-align: left;">3.6e+03</td>
<td style="text-align: left;">3.23e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,5]</td>
<td style="text-align: left;">-0.0811</td>
<td style="text-align: left;">-0.0821</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">(-0.395, 0.24)</td>
<td style="text-align: left;">2.74e+03</td>
<td style="text-align: left;">2.54e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,6]</td>
<td style="text-align: left;">0.025</td>
<td style="text-align: left;">0.0266</td>
<td style="text-align: left;">0.186</td>
<td style="text-align: left;">0.188</td>
<td style="text-align: left;">(-0.287, 0.329)</td>
<td style="text-align: left;">3.96e+03</td>
<td style="text-align: left;">2.93e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,6]</td>
<td style="text-align: left;">0.0203</td>
<td style="text-align: left;">0.0192</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">(-0.305, 0.343)</td>
<td style="text-align: left;">3.08e+03</td>
<td style="text-align: left;">2.99e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[3,6]</td>
<td style="text-align: left;">-0.0955</td>
<td style="text-align: left;">-0.097</td>
<td style="text-align: left;">0.177</td>
<td style="text-align: left;">0.178</td>
<td style="text-align: left;">(-0.393, 0.198)</td>
<td style="text-align: left;">2.72e+03</td>
<td style="text-align: left;">2.65e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[4,6]</td>
<td style="text-align: left;">-0.024</td>
<td style="text-align: left;">-0.0256</td>
<td style="text-align: left;">0.201</td>
<td style="text-align: left;">0.202</td>
<td style="text-align: left;">(-0.358, 0.314)</td>
<td style="text-align: left;">3.27e+03</td>
<td style="text-align: left;">2.86e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[5,6]</td>
<td style="text-align: left;">0.0758</td>
<td style="text-align: left;">0.0771</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">0.203</td>
<td style="text-align: left;">(-0.249, 0.391)</td>
<td style="text-align: left;">3.6e+03</td>
<td style="text-align: left;">3.23e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,6]</td>
<td style="text-align: left;">0.112</td>
<td style="text-align: left;">0.118</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">(-0.221, 0.418)</td>
<td style="text-align: left;">2.95e+03</td>
<td style="text-align: left;">2.98e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,7]</td>
<td style="text-align: left;">0.187</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">0.165</td>
<td style="text-align: left;">0.166</td>
<td style="text-align: left;">(-0.0946, 0.45)</td>
<td style="text-align: left;">3.29e+03</td>
<td style="text-align: left;">2.79e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,7]</td>
<td style="text-align: left;">0.106</td>
<td style="text-align: left;">0.113</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">(-0.215, 0.413)</td>
<td style="text-align: left;">2.48e+03</td>
<td style="text-align: left;">2.91e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[3,7]</td>
<td style="text-align: left;">0.111</td>
<td style="text-align: left;">0.113</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.164</td>
<td style="text-align: left;">(-0.156, 0.37)</td>
<td style="text-align: left;">3.04e+03</td>
<td style="text-align: left;">2.53e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[4,7]</td>
<td style="text-align: left;">-0.0355</td>
<td style="text-align: left;">-0.0391</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.201</td>
<td style="text-align: left;">(-0.354, 0.287)</td>
<td style="text-align: left;">2.75e+03</td>
<td style="text-align: left;">3.1e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[5,7]</td>
<td style="text-align: left;">-0.0811</td>
<td style="text-align: left;">-0.0821</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">(-0.395, 0.24)</td>
<td style="text-align: left;">2.74e+03</td>
<td style="text-align: left;">2.54e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[6,7]</td>
<td style="text-align: left;">0.112</td>
<td style="text-align: left;">0.118</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">(-0.221, 0.418)</td>
<td style="text-align: left;">2.95e+03</td>
<td style="text-align: left;">2.98e+03</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(knitr<span class="sc">::</span><span class="fu">kable</span>(ptable <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">select</span>(<span class="sc">-</span>mad,<span class="sc">-</span>ess_bulk,<span class="sc">-</span>ess_tail) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter</span>(<span class="fu">str_detect</span>(parameter,<span class="st">"rho"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)), <span class="at">format =</span> <span class="st">"latex"</span>),  </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>           here<span class="sc">::</span><span class="fu">here</span>(model_tables_dir, <span class="st">"parameters-table.tex"</span>))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ptable, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(model_tables_dir, <span class="st">"parameters-table.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="half-lifes" class="level3">
<h3 class="anchored" data-anchor-id="half-lifes">Half-lifes</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>thetaHat <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"thetaHat"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="at">K10 =</span> <span class="st">`</span><span class="at">thetaHat[5]</span><span class="st">`</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="at">K14 =</span> <span class="st">`</span><span class="at">thetaHat[6]</span><span class="st">`</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="at">K41 =</span> <span class="st">`</span><span class="at">thetaHat[7]</span><span class="st">`</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="at">K20 =</span> <span class="st">`</span><span class="at">thetaHat[1]</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">thetaHat[3]</span><span class="st">`</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="at">K23 =</span> <span class="st">`</span><span class="at">thetaHat[2]</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">thetaHat[3]</span><span class="st">`</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="at">K32 =</span> <span class="st">`</span><span class="at">thetaHat[2]</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">thetaHat[4]</span><span class="st">`</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="at">beta_abs=</span> <span class="fl">0.5</span><span class="sc">*</span>(K14<span class="sc">+</span>K41<span class="sc">+</span>K10<span class="sc">-</span><span class="fu">sqrt</span>((K14<span class="sc">+</span>K41<span class="sc">+</span>K10)<span class="sc">^</span><span class="dv">2-4</span><span class="sc">*</span>K41<span class="sc">*</span>K10)),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="at">alpha_abs =</span> K41<span class="sc">*</span>K10<span class="sc">/</span>beta_abs,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="at">beta_dis=</span> <span class="fl">0.5</span><span class="sc">*</span>(K23<span class="sc">+</span>K32<span class="sc">+</span>K20<span class="sc">-</span><span class="fu">sqrt</span>((K23<span class="sc">+</span>K32<span class="sc">+</span>K20)<span class="sc">^</span><span class="dv">2-4</span><span class="sc">*</span>K32<span class="sc">*</span>K20)),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="at">alpha_dis =</span> K32<span class="sc">*</span>K20<span class="sc">/</span>beta_dis,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="at">thalf_beta_abs =</span> <span class="fl">0.693</span><span class="sc">/</span>beta_abs,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="at">thalf_alpha_abs =</span> <span class="fl">0.693</span><span class="sc">/</span>alpha_abs,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="at">thalf_beta_dis =</span> <span class="fl">0.693</span><span class="sc">/</span>beta_dis,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="at">thalf_alpha_dis =</span> <span class="fl">0.693</span><span class="sc">/</span>alpha_dis) <span class="sc">%&gt;%</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mthalf_beta_abs =</span> <span class="fu">mean</span>(thalf_beta_abs),</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">sdthalf_beta_abs =</span> <span class="fu">sd</span>(thalf_beta_abs),</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="at">mthalf_alpha_abs =</span> <span class="fu">mean</span>(thalf_alpha_abs),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="at">sdthalf_alpha_abs =</span> <span class="fu">sd</span>(thalf_alpha_abs),</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="at">mthalf_beta_dis =</span> <span class="fu">mean</span>(thalf_beta_dis),</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="at">sdthalf_beta_dis =</span> <span class="fu">sd</span>(thalf_beta_dis),</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="at">mthalf_alpha_dis =</span> <span class="fu">mean</span>(thalf_alpha_dis),</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="at">sdthalf_alpha_dis =</span> <span class="fu">sd</span>(thalf_alpha_dis))</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>thetaHat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  mthalf_beta_abs sdthalf_beta_abs mthalf_alpha_abs sdthalf_alpha_abs
            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;             &lt;dbl&gt;
1            29.7             5.76           0.0405            0.0103
# ℹ 4 more variables: mthalf_beta_dis &lt;dbl&gt;, sdthalf_beta_dis &lt;dbl&gt;,
#   mthalf_alpha_dis &lt;dbl&gt;, sdthalf_alpha_dis &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="trace-plots-1" class="level2">
<h2 class="anchored" data-anchor-id="trace-plots-1">Trace plots</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lp__"</span>, <span class="st">"CLHat"</span>, <span class="st">"QHat"</span>, <span class="st">"V1Hat"</span>, <span class="st">"V2Hat"</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">"KAHat"</span>, <span class="st">"KA14Hat"</span>, <span class="st">"KA41Hat"</span>, <span class="st">"omega"</span>, <span class="st">"sigma"</span>,<span class="st">"nu"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens_overlay</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/trace-plots-mod3b-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/trace-plots-mod3b-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"trace-plots.png"</span>),<span class="at">plot =</span> p1, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"dense-plots.png"</span>),<span class="at">plot =</span> p2, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="individual-and-population-predictions-1" class="level2">
<h2 class="anchored" data-anchor-id="individual-and-population-predictions-1">Individual and population predictions</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ppc1 <span class="ot">&lt;-</span> <span class="fu">pred_by_id_fun</span>(mod_to_plot, xdata)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>ppc1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/IPRED-PRED-mod3b-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"pred-by-id.png"</span>),<span class="at">plot =</span> ppc1, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>figure_3<span class="ot">&lt;-</span>ppc1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="vpc-1" class="level2">
<h2 class="anchored" data-anchor-id="vpc-1">VPC</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>vpc_plot<span class="ot">&lt;-</span><span class="fu">vpc_fun</span>(mod_to_plot, xdata)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>vpc_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/VPC-mod3b-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"vpc.png"</span>),<span class="at">plot =</span> vpc_plot, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>figure_4b<span class="ot">&lt;-</span>vpc_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="gof-1" class="level2">
<h2 class="anchored" data-anchor-id="gof-1">GOF</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>plot_gof <span class="ot">&lt;-</span><span class="fu">gof_fun</span>(mod_to_plot, xdata)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>plot_gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/GOF-mod3b-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"gof.png"</span>),<span class="at">plot =</span> plot_gof, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>figure_5<span class="ot">&lt;-</span>plot_gof</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="individual-parameters-vs.-covariates-1" class="level2">
<h2 class="anchored" data-anchor-id="individual-parameters-vs.-covariates-1">Individual parameters vs.&nbsp;covariates</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>etaM<span class="ot">&lt;-</span><span class="fu">extract_etas_fun</span>(mod_to_plot,xdata)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>cont_cov <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"AGE//Age,y"</span>,<span class="st">"WT//Body Weight, kg"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>cat_cov <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"SEXF//Sex"</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">map</span>(cont_cov, \(x) <span class="fu">fun_cont_cov</span>(x,etaM))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">map</span>(cat_cov, \(x) <span class="fu">fun_cat_cov</span>(x,etaM))</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">c</span>(p1,p2)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/covariets-mod3b-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/covariets-mod3b-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/covariets-mod3b-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(plots), \(x) <span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                                 glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"cov-plots-{x}.png"</span>)),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">plot =</span> plots[[x]], </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "C:/Users/GUMed/Documents/PKPDprojects/sufentanil_epidural/deliv/figures/torsten/3b/cov-plots-1.png"

[[2]]
[1] "C:/Users/GUMed/Documents/PKPDprojects/sufentanil_epidural/deliv/figures/torsten/3b/cov-plots-2.png"

[[3]]
[1] "C:/Users/GUMed/Documents/PKPDprojects/sufentanil_epidural/deliv/figures/torsten/3b/cov-plots-3.png"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>figure_s1 <span class="ot">&lt;-</span> plots[[<span class="dv">1</span>]]</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>figure_s2 <span class="ot">&lt;-</span> plots[[<span class="dv">2</span>]]</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>figure_s3 <span class="ot">&lt;-</span> plots[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="shrinkage" class="level2">
<h2 class="anchored" data-anchor-id="shrinkage">Shrinkage</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>etas <span class="ot">&lt;-</span>  posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"etaM"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"eta"</span>), <span class="sc">~</span><span class="fu">log</span>(.x)))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>errors <span class="ot">&lt;-</span>  posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"errors"</span>))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>bbr.bayes<span class="sc">::</span><span class="fu">shrinkage</span>(etas,<span class="st">"etaM"</span>,<span class="at">group_idx =</span> <span class="dv">1</span>, <span class="at">use_sd =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.72644 54.62285 11.43232 75.92834 62.08986 48.25882 28.07558</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>bbr.bayes<span class="sc">::</span><span class="fu">shrinkage</span>(errors,<span class="st">"errors"</span>, <span class="at">use_sd =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.44972</code></pre>
</div>
</div>
</section>
</section>
<section id="m3p-prior-predicitve-check.-2cmp-model-2cmp-absorption" class="level1">
<h1>M3p: Prior predicitve check. 2cmp model + 2cmp absorption</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mod3b  &lt;- read_model(file.path(model_dir, "3b"))</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mod3c &lt;- copy_model_from(mod3b, "3c", "ppc",.overwrite=T)</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>mod3c  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(<span class="fu">file.path</span>(model_dir, <span class="st">"3c"</span>))</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>mod3c_res <span class="ot">&lt;-</span> mod3c <span class="sc">%&gt;%</span> <span class="fu">submit_model</span>(<span class="at">.overwrite =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="run-stan-2" class="level2">
<h2 class="anchored" data-anchor-id="run-stan-2">Run stan</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="ot">=</span> <span class="st">"3c"</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>model_figures_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(figures_dir, model_name)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>model_tables_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(tables_dir,model_name)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(model_figures_dir, <span class="at">recursive =</span> T)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(model_tables_dir, <span class="at">recursive =</span> T)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>mod2  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(here<span class="sc">::</span><span class="fu">here</span>(model_dir, model_name))</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>mod_to_plot <span class="ot">&lt;-</span> <span class="fu">read_fit_model</span>(mod2)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>xdata <span class="ot">&lt;-</span> xdata <span class="sc">%&gt;%</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(OUT<span class="sc">!=</span><span class="dv">1</span>, CMT<span class="sc">!=</span><span class="dv">22</span>, CMT<span class="sc">!=</span><span class="dv">33</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TIME =</span> <span class="fu">if_else</span>(infusion<span class="sc">==</span><span class="dv">0</span>,timepostinf,TIMEh))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="parameters-2" class="level2">
<h2 class="anchored" data-anchor-id="parameters-2">Parameters</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lp__"</span>, <span class="st">"CLHat"</span>, <span class="st">"QHat"</span>, <span class="st">"V1Hat"</span>, <span class="st">"V2Hat"</span>,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">"KAHat"</span>, <span class="st">"KA14Hat"</span>, <span class="st">"KA41Hat"</span>, <span class="st">"omega"</span>, <span class="st">"sigma"</span>,<span class="st">"nu"</span>,<span class="st">"rho"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>ptable <span class="ot">&lt;-</span><span class="fu">plot_param_tables</span>(mod_to_plot, pars)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>ptable<span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">parameter</th>
<th style="text-align: left;">mean</th>
<th style="text-align: left;">median</th>
<th style="text-align: left;">sd</th>
<th style="text-align: left;">mad</th>
<th style="text-align: left;">90% CI</th>
<th style="text-align: left;">ess_bulk</th>
<th style="text-align: left;">ess_tail</th>
<th style="text-align: left;">rhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lp__</td>
<td style="text-align: left;">-96</td>
<td style="text-align: left;">-95.6</td>
<td style="text-align: left;">9.25</td>
<td style="text-align: left;">9.1</td>
<td style="text-align: left;">(-112, -81.3)</td>
<td style="text-align: left;">1.38e+03</td>
<td style="text-align: left;">1.9e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">CLHat</td>
<td style="text-align: left;">46.8</td>
<td style="text-align: left;">45.3</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">11.1</td>
<td style="text-align: left;">(29.9, 68.8)</td>
<td style="text-align: left;">1.03e+04</td>
<td style="text-align: left;">2.58e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">QHat</td>
<td style="text-align: left;">39.5</td>
<td style="text-align: left;">38.2</td>
<td style="text-align: left;">10.4</td>
<td style="text-align: left;">10.1</td>
<td style="text-align: left;">( 25, 58.3)</td>
<td style="text-align: left;">8.16e+03</td>
<td style="text-align: left;">3.26e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">V1Hat</td>
<td style="text-align: left;">8.17</td>
<td style="text-align: left;">7.93</td>
<td style="text-align: left;">2.03</td>
<td style="text-align: left;">1.91</td>
<td style="text-align: left;">(5.27, 11.8)</td>
<td style="text-align: left;">9.67e+03</td>
<td style="text-align: left;">2.79e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V2Hat</td>
<td style="text-align: left;">497</td>
<td style="text-align: left;">482</td>
<td style="text-align: left;">125</td>
<td style="text-align: left;">116</td>
<td style="text-align: left;">( 324, 723)</td>
<td style="text-align: left;">7.97e+03</td>
<td style="text-align: left;">2.6e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">KAHat</td>
<td style="text-align: left;">4.87</td>
<td style="text-align: left;">4.59</td>
<td style="text-align: left;">1.98</td>
<td style="text-align: left;">2.06</td>
<td style="text-align: left;">(2.09, 8.65)</td>
<td style="text-align: left;">5.97e+03</td>
<td style="text-align: left;">1.67e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KA14Hat</td>
<td style="text-align: left;">5.53</td>
<td style="text-align: left;">4.84</td>
<td style="text-align: left;">2.98</td>
<td style="text-align: left;">2.37</td>
<td style="text-align: left;">(2.15, 11)</td>
<td style="text-align: left;">9.43e+03</td>
<td style="text-align: left;">2.99e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">KA41Hat</td>
<td style="text-align: left;">0.0821</td>
<td style="text-align: left;">0.0818</td>
<td style="text-align: left;">0.0387</td>
<td style="text-align: left;">0.0397</td>
<td style="text-align: left;">(0.0184, 0.148)</td>
<td style="text-align: left;">1.92e+03</td>
<td style="text-align: left;">692</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[1]</td>
<td style="text-align: left;">0.413</td>
<td style="text-align: left;">0.4</td>
<td style="text-align: left;">0.106</td>
<td style="text-align: left;">0.103</td>
<td style="text-align: left;">(0.264, 0.606)</td>
<td style="text-align: left;">9.55e+03</td>
<td style="text-align: left;">2.62e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">omega[2]</td>
<td style="text-align: left;">0.413</td>
<td style="text-align: left;">0.401</td>
<td style="text-align: left;">0.0997</td>
<td style="text-align: left;">0.0942</td>
<td style="text-align: left;">(0.27, 0.597)</td>
<td style="text-align: left;">9.18e+03</td>
<td style="text-align: left;">2.8e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[3]</td>
<td style="text-align: left;">0.413</td>
<td style="text-align: left;">0.399</td>
<td style="text-align: left;">0.105</td>
<td style="text-align: left;">0.0947</td>
<td style="text-align: left;">(0.264, 0.602)</td>
<td style="text-align: left;">8.87e+03</td>
<td style="text-align: left;">2.62e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">omega[4]</td>
<td style="text-align: left;">0.414</td>
<td style="text-align: left;">0.4</td>
<td style="text-align: left;">0.106</td>
<td style="text-align: left;">0.0995</td>
<td style="text-align: left;">(0.264, 0.603)</td>
<td style="text-align: left;">8.22e+03</td>
<td style="text-align: left;">2.86e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[5]</td>
<td style="text-align: left;">0.415</td>
<td style="text-align: left;">0.401</td>
<td style="text-align: left;">0.107</td>
<td style="text-align: left;">0.102</td>
<td style="text-align: left;">(0.267, 0.615)</td>
<td style="text-align: left;">7.95e+03</td>
<td style="text-align: left;">2.41e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">omega[6]</td>
<td style="text-align: left;">0.414</td>
<td style="text-align: left;">0.401</td>
<td style="text-align: left;">0.109</td>
<td style="text-align: left;">0.0969</td>
<td style="text-align: left;">(0.262, 0.614)</td>
<td style="text-align: left;">9.02e+03</td>
<td style="text-align: left;">2.21e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">omega[7]</td>
<td style="text-align: left;">0.413</td>
<td style="text-align: left;">0.401</td>
<td style="text-align: left;">0.102</td>
<td style="text-align: left;">0.0979</td>
<td style="text-align: left;">(0.269, 0.597)</td>
<td style="text-align: left;">9.38e+03</td>
<td style="text-align: left;">2.53e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma</td>
<td style="text-align: left;">0.206</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.0522</td>
<td style="text-align: left;">0.0496</td>
<td style="text-align: left;">(0.132, 0.3)</td>
<td style="text-align: left;">9.07e+03</td>
<td style="text-align: left;">2.79e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nu</td>
<td style="text-align: left;">20.8</td>
<td style="text-align: left;">17.1</td>
<td style="text-align: left;">14.5</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">(4.98, 49.8)</td>
<td style="text-align: left;">5.4e+03</td>
<td style="text-align: left;">2.02e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[2,1]</td>
<td style="text-align: left;">-0.00505</td>
<td style="text-align: left;">-0.00686</td>
<td style="text-align: left;">0.201</td>
<td style="text-align: left;">0.207</td>
<td style="text-align: left;">(-0.339, 0.327)</td>
<td style="text-align: left;">8.37e+03</td>
<td style="text-align: left;">2.71e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[3,1]</td>
<td style="text-align: left;">0.00254</td>
<td style="text-align: left;">0.00345</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">(-0.321, 0.324)</td>
<td style="text-align: left;">8.62e+03</td>
<td style="text-align: left;">2.62e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[4,1]</td>
<td style="text-align: left;">-0.00157</td>
<td style="text-align: left;">-0.00236</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">(-0.312, 0.32)</td>
<td style="text-align: left;">1.07e+04</td>
<td style="text-align: left;">2.22e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,1]</td>
<td style="text-align: left;">0.00304</td>
<td style="text-align: left;">0.0037</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">0.208</td>
<td style="text-align: left;">(-0.326, 0.328)</td>
<td style="text-align: left;">7.87e+03</td>
<td style="text-align: left;">2.63e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[6,1]</td>
<td style="text-align: left;">0.0016</td>
<td style="text-align: left;">0.00551</td>
<td style="text-align: left;">0.202</td>
<td style="text-align: left;">0.204</td>
<td style="text-align: left;">(-0.33, 0.339)</td>
<td style="text-align: left;">1.08e+04</td>
<td style="text-align: left;">2.81e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,1]</td>
<td style="text-align: left;">0.00108</td>
<td style="text-align: left;">0.00215</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">(-0.319, 0.314)</td>
<td style="text-align: left;">9.02e+03</td>
<td style="text-align: left;">2.97e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,2]</td>
<td style="text-align: left;">-0.00505</td>
<td style="text-align: left;">-0.00686</td>
<td style="text-align: left;">0.201</td>
<td style="text-align: left;">0.207</td>
<td style="text-align: left;">(-0.339, 0.327)</td>
<td style="text-align: left;">8.37e+03</td>
<td style="text-align: left;">2.71e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[3,2]</td>
<td style="text-align: left;">-0.00206</td>
<td style="text-align: left;">0.000252</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">0.206</td>
<td style="text-align: left;">(-0.323, 0.315)</td>
<td style="text-align: left;">6.04e+03</td>
<td style="text-align: left;">2.71e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[4,2]</td>
<td style="text-align: left;">-0.000285</td>
<td style="text-align: left;">0.00421</td>
<td style="text-align: left;">0.188</td>
<td style="text-align: left;">0.185</td>
<td style="text-align: left;">(-0.316, 0.31)</td>
<td style="text-align: left;">7.31e+03</td>
<td style="text-align: left;">2.91e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,2]</td>
<td style="text-align: left;">0.00258</td>
<td style="text-align: left;">0.00294</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">(-0.311, 0.31)</td>
<td style="text-align: left;">7.05e+03</td>
<td style="text-align: left;">2.87e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[6,2]</td>
<td style="text-align: left;">-0.00068</td>
<td style="text-align: left;">-0.0008</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">0.202</td>
<td style="text-align: left;">(-0.322, 0.316)</td>
<td style="text-align: left;">6.62e+03</td>
<td style="text-align: left;">2.74e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,2]</td>
<td style="text-align: left;">0.0013</td>
<td style="text-align: left;">0.0064</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">(-0.326, 0.32)</td>
<td style="text-align: left;">7.76e+03</td>
<td style="text-align: left;">2.72e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,3]</td>
<td style="text-align: left;">0.00254</td>
<td style="text-align: left;">0.00345</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">(-0.321, 0.324)</td>
<td style="text-align: left;">8.62e+03</td>
<td style="text-align: left;">2.62e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,3]</td>
<td style="text-align: left;">-0.00206</td>
<td style="text-align: left;">0.000252</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">0.206</td>
<td style="text-align: left;">(-0.323, 0.315)</td>
<td style="text-align: left;">6.04e+03</td>
<td style="text-align: left;">2.71e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[4,3]</td>
<td style="text-align: left;">0.001</td>
<td style="text-align: left;">-0.00272</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">(-0.304, 0.318)</td>
<td style="text-align: left;">6.17e+03</td>
<td style="text-align: left;">2.77e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,3]</td>
<td style="text-align: left;">-0.00442</td>
<td style="text-align: left;">-0.00475</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.207</td>
<td style="text-align: left;">(-0.326, 0.321)</td>
<td style="text-align: left;">7.13e+03</td>
<td style="text-align: left;">3.11e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[6,3]</td>
<td style="text-align: left;">0.00215</td>
<td style="text-align: left;">0.00378</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">(-0.322, 0.322)</td>
<td style="text-align: left;">5.61e+03</td>
<td style="text-align: left;">2.67e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,3]</td>
<td style="text-align: left;">0.00159</td>
<td style="text-align: left;">0.00178</td>
<td style="text-align: left;">0.197</td>
<td style="text-align: left;">0.204</td>
<td style="text-align: left;">(-0.322, 0.324)</td>
<td style="text-align: left;">5.55e+03</td>
<td style="text-align: left;">2.95e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,4]</td>
<td style="text-align: left;">-0.00157</td>
<td style="text-align: left;">-0.00236</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">(-0.312, 0.32)</td>
<td style="text-align: left;">1.07e+04</td>
<td style="text-align: left;">2.22e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,4]</td>
<td style="text-align: left;">-0.000285</td>
<td style="text-align: left;">0.00421</td>
<td style="text-align: left;">0.188</td>
<td style="text-align: left;">0.185</td>
<td style="text-align: left;">(-0.316, 0.31)</td>
<td style="text-align: left;">7.31e+03</td>
<td style="text-align: left;">2.91e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[3,4]</td>
<td style="text-align: left;">0.001</td>
<td style="text-align: left;">-0.00272</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">(-0.304, 0.318)</td>
<td style="text-align: left;">6.17e+03</td>
<td style="text-align: left;">2.77e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[5,4]</td>
<td style="text-align: left;">0.00461</td>
<td style="text-align: left;">0.00662</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">0.205</td>
<td style="text-align: left;">(-0.322, 0.325)</td>
<td style="text-align: left;">5.94e+03</td>
<td style="text-align: left;">2.62e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[6,4]</td>
<td style="text-align: left;">-0.00369</td>
<td style="text-align: left;">-0.00281</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">(-0.328, 0.32)</td>
<td style="text-align: left;">6.69e+03</td>
<td style="text-align: left;">2.61e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,4]</td>
<td style="text-align: left;">0.00135</td>
<td style="text-align: left;">0.000543</td>
<td style="text-align: left;">0.197</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">(-0.323, 0.327)</td>
<td style="text-align: left;">6.14e+03</td>
<td style="text-align: left;">2.81e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,5]</td>
<td style="text-align: left;">0.00304</td>
<td style="text-align: left;">0.0037</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">0.208</td>
<td style="text-align: left;">(-0.326, 0.328)</td>
<td style="text-align: left;">7.87e+03</td>
<td style="text-align: left;">2.63e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,5]</td>
<td style="text-align: left;">0.00258</td>
<td style="text-align: left;">0.00294</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">(-0.311, 0.31)</td>
<td style="text-align: left;">7.05e+03</td>
<td style="text-align: left;">2.87e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[3,5]</td>
<td style="text-align: left;">-0.00442</td>
<td style="text-align: left;">-0.00475</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.207</td>
<td style="text-align: left;">(-0.326, 0.321)</td>
<td style="text-align: left;">7.13e+03</td>
<td style="text-align: left;">3.11e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[4,5]</td>
<td style="text-align: left;">0.00461</td>
<td style="text-align: left;">0.00662</td>
<td style="text-align: left;">0.199</td>
<td style="text-align: left;">0.205</td>
<td style="text-align: left;">(-0.322, 0.325)</td>
<td style="text-align: left;">5.94e+03</td>
<td style="text-align: left;">2.62e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[6,5]</td>
<td style="text-align: left;">0.0003</td>
<td style="text-align: left;">0.000657</td>
<td style="text-align: left;">0.201</td>
<td style="text-align: left;">0.208</td>
<td style="text-align: left;">(-0.337, 0.323)</td>
<td style="text-align: left;">4.44e+03</td>
<td style="text-align: left;">2.94e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,5]</td>
<td style="text-align: left;">0.0026</td>
<td style="text-align: left;">0.0049</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">0.203</td>
<td style="text-align: left;">(-0.329, 0.324)</td>
<td style="text-align: left;">5.04e+03</td>
<td style="text-align: left;">2.85e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,6]</td>
<td style="text-align: left;">0.0016</td>
<td style="text-align: left;">0.00551</td>
<td style="text-align: left;">0.202</td>
<td style="text-align: left;">0.204</td>
<td style="text-align: left;">(-0.33, 0.339)</td>
<td style="text-align: left;">1.08e+04</td>
<td style="text-align: left;">2.81e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,6]</td>
<td style="text-align: left;">-0.00068</td>
<td style="text-align: left;">-0.0008</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">0.202</td>
<td style="text-align: left;">(-0.322, 0.316)</td>
<td style="text-align: left;">6.62e+03</td>
<td style="text-align: left;">2.74e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[3,6]</td>
<td style="text-align: left;">0.00215</td>
<td style="text-align: left;">0.00378</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">(-0.322, 0.322)</td>
<td style="text-align: left;">5.61e+03</td>
<td style="text-align: left;">2.67e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[4,6]</td>
<td style="text-align: left;">-0.00369</td>
<td style="text-align: left;">-0.00281</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">(-0.328, 0.32)</td>
<td style="text-align: left;">6.69e+03</td>
<td style="text-align: left;">2.61e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[5,6]</td>
<td style="text-align: left;">0.0003</td>
<td style="text-align: left;">0.000657</td>
<td style="text-align: left;">0.201</td>
<td style="text-align: left;">0.208</td>
<td style="text-align: left;">(-0.337, 0.323)</td>
<td style="text-align: left;">4.44e+03</td>
<td style="text-align: left;">2.94e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[7,6]</td>
<td style="text-align: left;">0.00192</td>
<td style="text-align: left;">0.00311</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">(-0.327, 0.331)</td>
<td style="text-align: left;">3.89e+03</td>
<td style="text-align: left;">2.65e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[1,7]</td>
<td style="text-align: left;">0.00108</td>
<td style="text-align: left;">0.00215</td>
<td style="text-align: left;">0.192</td>
<td style="text-align: left;">0.193</td>
<td style="text-align: left;">(-0.319, 0.314)</td>
<td style="text-align: left;">9.02e+03</td>
<td style="text-align: left;">2.97e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[2,7]</td>
<td style="text-align: left;">0.0013</td>
<td style="text-align: left;">0.0064</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">0.194</td>
<td style="text-align: left;">(-0.326, 0.32)</td>
<td style="text-align: left;">7.76e+03</td>
<td style="text-align: left;">2.72e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[3,7]</td>
<td style="text-align: left;">0.00159</td>
<td style="text-align: left;">0.00178</td>
<td style="text-align: left;">0.197</td>
<td style="text-align: left;">0.204</td>
<td style="text-align: left;">(-0.322, 0.324)</td>
<td style="text-align: left;">5.55e+03</td>
<td style="text-align: left;">2.95e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[4,7]</td>
<td style="text-align: left;">0.00135</td>
<td style="text-align: left;">0.000543</td>
<td style="text-align: left;">0.197</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">(-0.323, 0.327)</td>
<td style="text-align: left;">6.14e+03</td>
<td style="text-align: left;">2.81e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rho[5,7]</td>
<td style="text-align: left;">0.0026</td>
<td style="text-align: left;">0.0049</td>
<td style="text-align: left;">0.198</td>
<td style="text-align: left;">0.203</td>
<td style="text-align: left;">(-0.329, 0.324)</td>
<td style="text-align: left;">5.04e+03</td>
<td style="text-align: left;">2.85e+03</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rho[6,7]</td>
<td style="text-align: left;">0.00192</td>
<td style="text-align: left;">0.00311</td>
<td style="text-align: left;">0.196</td>
<td style="text-align: left;">0.195</td>
<td style="text-align: left;">(-0.327, 0.331)</td>
<td style="text-align: left;">3.89e+03</td>
<td style="text-align: left;">2.65e+03</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(knitr<span class="sc">::</span><span class="fu">kable</span>(ptable <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">select</span>(<span class="sc">-</span>mad,<span class="sc">-</span>ess_bulk,<span class="sc">-</span>ess_tail) <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter</span>(<span class="fu">str_detect</span>(parameter,<span class="st">"rho"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)), <span class="at">format =</span> <span class="st">"latex"</span>),  </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>           here<span class="sc">::</span><span class="fu">here</span>(model_tables_dir, <span class="st">"parameters-table.tex"</span>))</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ptable, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(model_tables_dir, <span class="st">"parameters-table.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="parameters-figure" class="level2">
<h2 class="anchored" data-anchor-id="parameters-figure">Parameters (figure)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"CLHat"</span>, <span class="st">"QHat"</span>, <span class="st">"V1Hat"</span>, <span class="st">"V2Hat"</span>,<span class="st">"KAHat"</span>, <span class="st">"KA14Hat"</span>, <span class="st">"KA41Hat"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"fr-values.png"</span>),<span class="at">plot =</span> p1, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/param2-mod3c-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="trace-plots-2" class="level2">
<h2 class="anchored" data-anchor-id="trace-plots-2">Trace plots</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lp__"</span>, <span class="st">"CLHat"</span>, <span class="st">"QHat"</span>, <span class="st">"V1Hat"</span>, <span class="st">"V2Hat"</span>,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">"KAHat"</span>, <span class="st">"KA14Hat"</span>, <span class="st">"KA41Hat"</span>, <span class="st">"omega"</span>, <span class="st">"sigma"</span>,<span class="st">"nu"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens_overlay</span>(mod_to_plot<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/trace-plots-mod3c-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/trace-plots-mod3c-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"trace-plots.png"</span>),<span class="at">plot =</span> p1, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"dense-plots.png"</span>),<span class="at">plot =</span> p2, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="individual-and-population-predictions-prior-predictive-check" class="level2">
<h2 class="anchored" data-anchor-id="individual-and-population-predictions-prior-predictive-check">Individual and population predictions (Prior predictive check)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>ppc1 <span class="ot">&lt;-</span> <span class="fu">pred_by_id_fun</span>(mod_to_plot, xdata)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>ppc1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/IPRED-PRED-mod3c-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"pred-by-id.png"</span>),<span class="at">plot =</span> ppc1, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>figure_1 <span class="ot">&lt;-</span>ppc1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="vpc-prior-predictive-check" class="level2">
<h2 class="anchored" data-anchor-id="vpc-prior-predictive-check">VPC (Prior predictive check)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>vpc_plot<span class="ot">&lt;-</span><span class="fu">vpc_fun</span>(mod_to_plot, xdata)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>vpc_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/VPC-mod3c-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"vpc.png"</span>),<span class="at">plot =</span> vpc_plot, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="compare-m3b" class="level2">
<h2 class="anchored" data-anchor-id="compare-m3b">Compare M3b</h2>
<section id="parameters-figure-1" class="level3">
<h3 class="anchored" data-anchor-id="parameters-figure-1">Parameters (figure)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>subdir <span class="ot">=</span> <span class="st">"3b"</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>model_figures_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(figures_dir, subdir)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>model_tables_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(tables_dir,subdir)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(model_figures_dir, <span class="at">recursive =</span> T)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(model_tables_dir, <span class="at">recursive =</span> T)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>modx  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(here<span class="sc">::</span><span class="fu">here</span>(model_dir, <span class="st">"3b"</span>))</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>mod_to_plot1 <span class="ot">&lt;-</span> <span class="fu">read_fit_model</span>(modx)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>modx  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(here<span class="sc">::</span><span class="fu">here</span>(model_dir, <span class="st">"3c"</span>))</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>mod_to_plot2 <span class="ot">&lt;-</span> <span class="fu">read_fit_model</span>(modx)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"CLHat"</span>, <span class="st">"QHat"</span>, <span class="st">"V1Hat"</span>, <span class="st">"V2Hat"</span>,<span class="st">"KAHat"</span>, <span class="st">"KA14Hat"</span>, <span class="st">"KA41Hat"</span>)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(mod_to_plot1<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(mod_to_plot2<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>p1_data <span class="ot">=</span> p1<span class="sc">$</span>plot<span class="sc">$</span>data<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"posterior"</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>p2_data <span class="ot">=</span> p2<span class="sc">$</span>plot<span class="sc">$</span>data<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"prior"</span>)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">=</span> <span class="fu">rbind</span>(p1_data,p2_data)<span class="sc">%&gt;%</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>type, <span class="at">x=</span>m))<span class="sc">+</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> l, <span class="at">xmax =</span> h), <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ll, <span class="at">xmax =</span> hh))<span class="sc">+</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parameter, <span class="at">scales=</span><span class="st">"free_x"</span>)</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>plot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/prior-posterior-mod3b-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"prior-posterior-1.png"</span>),<span class="at">plot =</span> plot1, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"omega"</span>, <span class="st">"sigma"</span>, <span class="st">"nu"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(mod_to_plot1<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(mod_to_plot2<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>p1_data <span class="ot">=</span> p1<span class="sc">$</span>plot<span class="sc">$</span>data<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"posterior"</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>p2_data <span class="ot">=</span> p2<span class="sc">$</span>plot<span class="sc">$</span>data<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"prior"</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">=</span> <span class="fu">rbind</span>(p1_data,p2_data)<span class="sc">%&gt;%</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>type, <span class="at">x=</span>m))<span class="sc">+</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> l, <span class="at">xmax =</span> h), <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ll, <span class="at">xmax =</span> hh))<span class="sc">+</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parameter, <span class="at">scales=</span><span class="st">"free_x"</span>)</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>plot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/prior-posterior-mod3b-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"prior-posterior-2.png"</span>), <span class="at">plot =</span> plot2, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"rho"</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(mod_to_plot1<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(mod_to_plot2<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>p1_data <span class="ot">=</span> p1<span class="sc">$</span>plot<span class="sc">$</span>data<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"posterior"</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>p2_data <span class="ot">=</span> p2<span class="sc">$</span>plot<span class="sc">$</span>data<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"prior"</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">=</span> <span class="fu">rbind</span>(p1_data,p2_data)<span class="sc">%&gt;%</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>type, <span class="at">x=</span>m))<span class="sc">+</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> l, <span class="at">xmax =</span> h), <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ll, <span class="at">xmax =</span> hh))<span class="sc">+</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parameter, <span class="at">scales=</span><span class="st">"free_x"</span>)<span class="sc">+</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>,<span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="st">"cm"</span>)), </span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>))</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>plot3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/prior-posterior-mod3b-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, <span class="st">"prior-posterior-3.png"</span>), <span class="at">plot =</span> plot3, <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>figure_s4 <span class="ot">&lt;-</span> plot1</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>figure_s5 <span class="ot">&lt;-</span> plot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="compare-models" class="level1">
<h1>Compare models</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(<span class="fu">list</span>(<span class="st">"2cmpdisp-1compabs"</span> <span class="ot">=</span> loo1, </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"2cmpdisp-2cmpabs"</span><span class="ot">=</span> loo3))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comp, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  elpd_diff se_diff
2cmpdisp-2cmpabs   0.00      0.00  
2cmpdisp-1compabs -2.56      6.55  </code></pre>
</div>
</div>
</section>
<section id="manuscript-figures" class="level1">
<h1>Manuscript figures</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>manuscript_figures_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(figures_dir, <span class="st">"manuscript"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(manuscript_figures_dir, <span class="at">recursive =</span> T)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>inf_labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"During infusion"</span>,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"Post infusion"</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>figure_4a <span class="ot">&lt;-</span> figure_4a <span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_manual</span>(<span class="sc">~</span>infusion, <span class="at">design =</span> <span class="st">"BA"</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">infusion =</span> inf_labs),</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">scales =</span> <span class="st">"free_x"</span>)<span class="sc">+</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_facet</span>(infusion <span class="sc">==</span> <span class="cn">TRUE</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>))</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>figure_4b <span class="ot">&lt;-</span> figure_4b <span class="sc">+</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_manual</span>(<span class="sc">~</span>infusion, <span class="at">design =</span> <span class="st">"BA"</span>, </span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">infusion =</span> inf_labs),</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_facet</span>(infusion <span class="sc">==</span> <span class="cn">TRUE</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>))</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>figure_1 <span class="ot">&lt;-</span> figure_1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>figure_4 <span class="ot">&lt;-</span> figure_4a<span class="sc">/</span>figure_4b<span class="sc">+</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)<span class="sc">+</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)<span class="sc">&amp;</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>                                <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(manuscript_figures_dir, <span class="st">"figure1.png"</span>),<span class="at">plot =</span> figure_1, <span class="at">width=</span><span class="dv">16</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(manuscript_figures_dir, <span class="st">"figure2.png"</span>),<span class="at">plot =</span> figure_2, <span class="at">width=</span><span class="dv">16</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(manuscript_figures_dir, <span class="st">"figure3.png"</span>),<span class="at">plot =</span> figure_3, <span class="at">width=</span><span class="dv">16</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(manuscript_figures_dir, <span class="st">"figure4.png"</span>),<span class="at">plot =</span> figure_4, <span class="at">width=</span><span class="dv">16</span>, <span class="at">height=</span><span class="dv">18</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(manuscript_figures_dir, <span class="st">"figure5.png"</span>),<span class="at">plot =</span> figure_5, <span class="at">width=</span><span class="dv">16</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>figure_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/manuscript-figures-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>figure_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/manuscript-figures-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>figure_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/manuscript-figures-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>figure_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/manuscript-figures-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>figure_5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bayesian-analysis_files/figure-html/manuscript-figures-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(manuscript_figures_dir, <span class="st">"figureS1.png"</span>),<span class="at">plot =</span> figure_s1, <span class="at">width=</span><span class="dv">16</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(manuscript_figures_dir, <span class="st">"figureS2.png"</span>),<span class="at">plot =</span> figure_s2, <span class="at">width=</span><span class="dv">16</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(manuscript_figures_dir, <span class="st">"figureS3.png"</span>),<span class="at">plot =</span> figure_s3, <span class="at">width=</span><span class="dv">16</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(manuscript_figures_dir, <span class="st">"figureS4.png"</span>),<span class="at">plot =</span> figure_s4, <span class="at">width=</span><span class="dv">16</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(manuscript_figures_dir, <span class="st">"figureS5.png"</span>),<span class="at">plot =</span> figure_s5, <span class="at">width=</span><span class="dv">16</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-Bartkowska-Sniatkowska2016-hm" class="csl-entry" role="listitem">
Bartkowska-Śniatkowska, A., Bienert, A., Wiczling, P., Rosada-Kurasińska, J., Zielińska, M., Warzybok, J., Borsuk, A., Tibboel, D., Kaliszan, R. and Grześkowiak, E. (2016) <span>“Pharmacokinetics of sufentanil during long-term infusion in critically ill pediatric patients,”</span> <em>J. Clin. Pharmacol.</em>, 56(1), pp. 109–115.
</div>
</div>
</section>
<section id="licenses" class="level1 unnumbered">
<h1 class="unnumbered">Licenses</h1>
<ul>
<li>Code &amp; copy; 2025, Paweł Wiczling, licensed under BSD-3.</li>
<li>Text &amp; copy; 2025, Paweł Wiczling, licensed under CC-BY-NC 4.0.</li>
</ul>
</section>
<section id="original-computing-environment" class="level1 unnumbered">
<h1 class="unnumbered">Original Computing Environment</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.1 (2023-06-16 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19045)

Matrix products: default


locale:
[1] LC_COLLATE=Polish_Poland.utf8  LC_CTYPE=Polish_Poland.utf8   
[3] LC_MONETARY=Polish_Poland.utf8 LC_NUMERIC=C                  
[5] LC_TIME=Polish_Poland.utf8    

time zone: Europe/Warsaw
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] loo_2.8.0           ggh4x_0.3.0         posterior_1.6.0    
 [4] gridExtra_2.3       cmdstanr_0.8.1.9000 nmrec_0.4.0        
 [7] pmtables_0.6.0.9000 scales_1.3.0        here_1.0.1         
[10] whisker_0.4.1       glue_1.8.0          lubridate_1.9.4    
[13] forcats_1.0.0       stringr_1.5.1       purrr_1.0.2        
[16] readr_2.1.5         tidyr_1.3.1         tibble_3.2.1       
[19] tidyverse_2.0.0     data.table_1.16.4   knitr_1.46         
[22] naniar_1.1.0        pmplots_0.4.1       vpc_1.2.2          
[25] mrgsolve_1.4.1      patchwork_1.2.0     ggplot2_3.5.1      
[28] dplyr_1.1.4         bbr.bayes_0.2.1     bbr_1.12.0         
[31] pracma_2.4.4       

loaded via a namespace (and not attached):
 [1] svUnit_1.0.6         tidyselect_1.2.1     viridisLite_0.4.2   
 [4] farver_2.1.2         tidybayes_3.0.7      fastmap_1.2.0       
 [7] tensorA_0.36.2.1     digest_0.6.37        timechange_0.3.0    
[10] lifecycle_1.0.4      processx_3.8.5       magrittr_2.0.3      
[13] compiler_4.3.1       rlang_1.1.4          tools_4.3.1         
[16] yaml_2.3.10          labeling_0.4.3       htmlwidgets_1.6.4   
[19] classInt_0.4-10      plyr_1.8.9           xml2_1.3.6          
[22] RColorBrewer_1.1-3   KernSmooth_2.23-21   abind_1.4-8         
[25] withr_3.0.2          grid_4.3.1           diffobj_0.3.5       
[28] e1071_1.7-14         colorspace_2.1-0     cli_3.6.3           
[31] rmarkdown_2.27       crayon_1.5.3         ragg_1.3.2          
[34] generics_0.1.3       rstudioapi_0.16.0    reshape2_1.4.4      
[37] tzdb_0.4.0           proxy_0.4-27         bayesplot_1.11.1    
[40] assertthat_0.2.1     parallel_4.3.1       matrixStats_1.5.0   
[43] vctrs_0.6.5          jsonlite_1.8.9       callr_3.7.6         
[46] arrayhelpers_1.1-0   hms_1.1.3            visdat_0.6.0        
[49] systemfonts_1.1.0    ggdist_3.3.2         ps_1.8.1            
[52] distributional_0.5.0 stringi_1.8.4        gtable_0.3.5        
[55] munsell_0.5.1        pillar_1.10.1        htmltools_0.5.8.1   
[58] R6_2.5.1             textshaping_0.4.0    rprojroot_2.0.4     
[61] lattice_0.21-8       evaluate_0.23        kableExtra_1.4.0    
[64] backports_1.5.0      class_7.3-22         Rcpp_1.0.13-1       
[67] coda_0.19-4.1        svglite_2.1.3        checkmate_2.3.2     
[70] xfun_0.50            fs_1.6.5             pkgconfig_2.0.3     </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>